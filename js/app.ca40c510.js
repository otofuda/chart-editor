(function(){"use strict";var e={5683:function(e,t,s){var i=s(5471),n=s(7422),o=s(8505),a=s(3279),r=s(375),l=s(1689),c=s(8834),d=s(8738),u=s(3882),p=s(1526),h=s(6565),m=s(4957),f=s(6278),y=s(4089),b=s(1770),v=s(8),A=s(9456),g=s(980),_=s(2987),w=s(1075),x=s(6453),k=s(6160),N=s(284),S=s(5757),C=s(8412),O=s(4564),T=s(7891),D=s(1863),P=s(3021),M=s(7410),L=s(2457),$=s(5443),j=s(9584),E=s(4661),B=s(40),F=s(2059),I=s(9940),H=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s(o.A,{attrs:{id:"app"}},[s("Preview",{attrs:{currentChart:e.currentChart,currentDifficulty:e.currentDifficulty,infoObject:e.chartObject.info,measureData:e.measureData,audioVolume:e.audioVolume,previewAudio:e.previewAudio,appendNote:e.getAppendNote,preAppendNotes:e.preAppendNotes,isShowDetail:e.isShowDetail,isCaptureMode:e.isCaptureMode,isPreviewMode:e.isPreviewMode,isImageMode:e.isImageMode}}),s(f.A,{staticClass:"panel",attrs:{fluid:""}},[s("img",{staticClass:"logo",attrs:{src:"https://otofuda.github.io/chart-editor/logo.png",alt:"Otofuda Chart Editor V2"}}),s("h3",[e._v("譜面ファイル")]),s(C.A,{attrs:{align:"center"}},[s(v.A,{attrs:{accept:".json, application/json",label:"ファイルを選択","hide-details":"",outlined:"",dense:"","prepend-icon":"mdi-folder"},on:{change:e.readFile}}),s(p.A,[s(O.A,{attrs:{items:e.difficulties,label:"難易度",align:"left","hide-details":"",outlined:"",dense:"","menu-props":{rounded:"lg"}},model:{value:e.currentDifficulty,callback:function(t){e.currentDifficulty=t},expression:"currentDifficulty"}})],1)],1),s(C.A,{staticClass:"difficulty-select"},[s(r.A,{attrs:{small:"",dark:"",color:"blue"},on:{click:function(t){e.currentDifficulty="raku"}}},[e._v(" RAKU ")]),s(r.A,{attrs:{small:"",dark:"",color:"green"},on:{click:function(t){e.currentDifficulty="easy"}}},[e._v(" EASY ")]),s(r.A,{attrs:{small:"",dark:"",color:"orange"},on:{click:function(t){e.currentDifficulty="normal"}}},[e._v(" NORMAL ")]),s(r.A,{attrs:{small:"",dark:"",color:"#ff0984"},on:{click:function(t){e.currentDifficulty="hard"}}},[e._v(" HARD ")]),s(r.A,{attrs:{small:"",dark:"",color:"purple"},on:{click:function(t){e.currentDifficulty="extra"}}},[e._v(" EXTRA ")])],1),s("h3",[e._v("ノートの挿入（仮配置："+e._s(e.preAppendNotes.size)+"個）")]),s(d.A,{staticClass:"mb-2",attrs:{label:"ノート挿入モード","hide-details":""},model:{value:e.isAppendMode,callback:function(t){e.isAppendMode=t},expression:"isAppendMode"}}),s("div",{directives:[{name:"show",rawName:"v-show",value:e.isAppendMode,expression:"isAppendMode"}]},[s(C.A,{attrs:{justify:"space-between"}},[s(d.A,{staticClass:"mt-0 ml-3",attrs:{label:"編集小節を自動追従","hide-details":""},model:{value:e.isAutoFollow,callback:function(t){e.isAutoFollow=t},expression:"isAutoFollow"}}),s(r.A,{staticClass:"ml-4 white--text",attrs:{color:"orange darken-4",outlined:""},on:{click:function(t){return e.appendSimultaneously(e.appendNote)}}},[e._v(" このノートのみを全難易度に同時挿入 "),s(A.A,{attrs:{right:""}},[e._v("mdi-plus-circle")])],1)],1),s(C.A,[s(p.A,{attrs:{cols:"12",sm:"3"}},[s(O.A,{attrs:{items:e.noteTypes,"hide-details":"",label:"ノート種別",outlined:"",dense:"","menu-props":{rounded:"lg"}},on:{change:e.changeAppendNoteType},scopedSlots:e._u([{key:"item",fn:function(t){var i=t.item;return[s(u.A,{staticClass:"mr-4",attrs:{label:"",outlined:""}},[e._v(e._s(i.value))]),e._v(" "+e._s(i.text)+" ")]}}]),model:{value:e.appendNote.type,callback:function(t){e.$set(e.appendNote,"type",t)},expression:"appendNote.type"}})],1),s(p.A,{attrs:{cols:"12",sm:"3"}},[s(I.A,{attrs:{label:"measure",outlined:"",dense:"","hide-details":"",type:"number",min:"0"},model:{value:e.appendNote.measure,callback:function(t){e.$set(e.appendNote,"measure",e._n(t))},expression:"appendNote.measure"}})],1),s(p.A,{attrs:{cols:"12",sm:"3"}},[s(I.A,{attrs:{label:"position",outlined:"",dense:"","hide-details":"",min:"0",max:e.appendNote.split-1,"background-color":"#f0f0b0"},on:{keydown:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.placeNotes(e.appendNote)},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"left",37,t.key,["Left","ArrowLeft"])||"button"in t&&0!==t.button?null:e.appendNoteToLeft(t)},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"right",39,t.key,["Right","ArrowRight"])||"button"in t&&2!==t.button?null:e.appendNoteToRight(t)},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"up",38,t.key,["Up","ArrowUp"])?null:e.appendNoteToUp(t)},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"down",40,t.key,["Down","ArrowDown"])?null:e.appendNoteToDown(t)}]},model:{value:e.appendNote.position,callback:function(t){e.$set(e.appendNote,"position",e._n(t))},expression:"appendNote.position"}})],1),s(p.A,{attrs:{cols:"12",sm:"3"}},[s(m.A,{attrs:{items:[4,8,16,32,12,24,48],label:"split",outlined:"","hide-details":"",dense:"","menu-props":{rounded:"lg"}},model:{value:e.appendNote.split,callback:function(t){e.$set(e.appendNote,"split",e._n(t))},expression:"appendNote.split"}})],1)],1),e._l(e.noteOptionsForAppendNote,(function(t,i){return s("div",{key:"option_"+i,staticClass:"my-4"},[s(I.A,{attrs:{"hide-details":"",label:t.label,type:t.type,"append-outer-icon":"mdi-help",outlined:"",dense:""},on:{"click:append-outer":function(s){return e.showSnackbar(t.label+"の説明："+t.desc)}},model:{value:e.appendNote.option[i],callback:function(t){e.$set(e.appendNote.option,i,t)},expression:"appendNote.option[i]"}})],1)})),94===e.appendNote.type?s(k.A,{attrs:{"close-on-content-click":!1,"max-width":"600","offset-overflow":""},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on,n=t.attrs;return[s(r.A,e._g(e._b({attrs:{color:"indigo",dark:"",outlined:""}},"v-btn",n,!1),i),[e._v(" テクスチャをデータベースから探す ")])]}}],null,!1,2506825503),model:{value:e.dialog.texture,callback:function(t){e.$set(e.dialog,"texture",t)},expression:"dialog.texture"}},[s(l.A,{attrs:{rounded:"lg"}},[s(E.A,{attrs:{"show-arrows":""},model:{value:e.textureCurrentTab,callback:function(t){e.textureCurrentTab=t},expression:"textureCurrentTab"}},[s(F.A,{attrs:{color:"indigo"}}),e._l(e.textureTabs,(function(t){return s($.A,{key:t},[e._v(" "+e._s(t)+" ")])}))],2),s(B.A,{model:{value:e.textureCurrentTab,callback:function(t){e.textureCurrentTab=t},expression:"textureCurrentTab"}},e._l(e.textureTabs,(function(t){return s(j.A,{key:t,staticClass:"px-6"},[s(C.A,e._l(e.texturePayload.contents.filter((function(e){return e.tab.includes(t)})),(function(t){return s(p.A,{key:t.id,attrs:{cols:"12",sm:"6",md:"4"}},[s(l.A,{staticClass:"texture-card",attrs:{rounded:"lg",elevation:"2"}},[s(g.A,{attrs:{src:t.url.startsWith("texture")?"https://db.otofuda.com/"+t.url:t.url,height:"100px"}},[s("span",{staticClass:"texture-card__name"},[e._v(" "+e._s(t.name)+" ")])]),s(c.SL,{staticClass:"justify-end pa-0"},[s(r.A,{attrs:{small:"",text:"",color:"primary"},on:{click:function(s){return e.setTexture(t)}}},[e._v(" これにする ")])],1)],1)],1)})),1)],1)})),1)],1)],1):e._e(),96===e.appendNote.type?s(C.A,{staticClass:"pl-2"},[s(h.A,{staticClass:"mr-4 mb-2",attrs:{swatches:e.colorSwatches,"show-swatches":"",elevation:"2","hide-inputs":""},model:{value:e.appendNoteColorOption,callback:function(t){e.appendNoteColorOption=t},expression:"appendNoteColorOption"}}),s("div",[s("div",[s("strong",[e._v("特殊な色を設定")])]),s(r.A,{staticClass:"my-2",attrs:{outlined:"",color:"primary"},on:{click:function(t){e.appendNote.option=["-1","-1","-1"]}}},[e._v(" 青赤(default)に戻す ")]),s("p",[s("code",[e._v("['-1', '-1', '-1']")]),e._v(" を設定します")])],1)],1):e._e(),s(C.A,{attrs:{align:"center",justify:"space-between"}},[s(S.A,{attrs:{row:"","prepend-icon":"mdi-view-column-outline",disabled:e.isLanelessNote(e.appendNote)},model:{value:e.appendNote.lane,callback:function(t){e.$set(e.appendNote,"lane",t)},expression:"appendNote.lane"}},e._l(5,(function(e){return s(N.A,{key:e,attrs:{value:e}})})),1),s("div",[s(r.A,{staticClass:"ml-1 white--text",attrs:{color:"green darken-1"},on:{click:function(t){return e.placeNotes(e.appendNote)}}},[e._v(" ノートを仮配置 "),s(A.A,{attrs:{right:""}},[e._v("mdi-keyboard-return")])],1),s(a.A,{attrs:{overlap:"",color:"orange darken-4",value:e.preAppendNotes.size,content:e.preAppendNotes.size}},[s(r.A,{staticClass:"ml-4 white--text",attrs:{color:"orange darken-4"},on:{click:function(t){return e.appendNotes.apply(void 0,e.preAppendNotes)}}},[e._v(" 挿入する "),s(A.A,{attrs:{right:""}},[e._v("mdi-plus-circle-outline")])],1)],1)],1)],1),s("div",{directives:[{name:"show",rawName:"v-show",value:2===e.appendNote.type||90==e.appendNote.type&&2===Number(e.appendNote.option[0]),expression:"appendNote.type === 2 || (appendNote.type == 90 && Number(appendNote.option[0]) === 2)"}],staticClass:"my-4"},[s(C.A,{attrs:{align:"center",justify:"space-between"}},[s("h4",[e._v("ロングノーツ編集")]),s(r.A,{staticClass:"white--text",attrs:{color:"green darken-1"},on:{click:e.addEndToAppendNote}},[e._v(" 終点を追加 ")])],1),e._l(e.appendNote.end,(function(t,i){return s("EndForm",{key:"append_end_"+i,attrs:{end:t,parent:e.appendNote,index:i,"max-measure":e.maxMeasure},on:{"delete-end":e.deleteEndOfAppendNote,"append-to-left":e.appendNoteToLeft,"append-to-right":e.appendNoteToRight,"append-to-up":e.appendNoteToUp,"append-to-down":e.appendNoteToDown,"place-notes":function(t){return e.placeNotes(e.appendNote)}}})})),0===e.appendNote.end.size?s(n.A,{staticClass:"mt-2",attrs:{dense:"",type:"warning",rounded:"lg"}},[e._v(" 終点が1つもありません ")]):e._e()],2)],2),s("h3",[e._v("プレビュー領域の設定")]),s("h5",[e._v("現在のハイスピードの速度値:"+e._s(e.musicBpm*e.beatHeight/100))]),s(D.A,{attrs:{"thumb-size":24,"thumb-label":"always",min:"20",max:"300","append-icon":"mdi-magnify-plus-outline","prepend-icon":"mdi-magnify-minus-outline",step:"10","hide-details":""},on:{"click:append":e.zoomIn,"click:prepend":e.zoomOut},model:{value:e.beatHeight,callback:function(t){e.beatHeight=t},expression:"beatHeight"}}),s(C.A,{attrs:{align:"center"}},[s(p.A,{attrs:{cols:"12",sm:"6"}},[s(v.A,{attrs:{accept:"audio/*",label:"楽曲ファイル選択",outlined:"",dense:"","prepend-icon":"mdi-music","hide-details":""},on:{change:e.readAudioFile}})],1),s(p.A,{attrs:{cols:"12",sm:"6"}},[s(D.A,{attrs:{"thumb-size":24,"thumb-label":"always",min:"0",max:"100","prepend-icon":"mdi-volume-high",step:"5","hide-details":""},model:{value:e.audioVolume,callback:function(t){e.audioVolume=t},expression:"audioVolume"}})],1)],1),s(C.A,{staticClass:"mb-4",attrs:{align:"center"}},[s(I.A,{attrs:{suffix:"小節へ",outlined:"",dense:"","hide-details":""},model:{value:e.scrollTo,callback:function(t){e.scrollTo=e._n(t)},expression:"scrollTo"}}),s(r.A,{staticClass:"ml-4",attrs:{color:"primary"},on:{click:function(t){return e.scrollToMeasure(e.scrollTo)}}},[s(A.A,{attrs:{left:""}},[e._v("mdi-arrow-right")]),e._v(" 遷移 ")],1)],1),s("h3",[e._v("プレビュー表示モード")]),s(C.A,{staticClass:"mb-0"},[s(d.A,{attrs:{"prepend-icon":"mdi-format-align-justify",label:"ノーツ詳細を表示","hide-details":""},model:{value:e.isShowDetail,callback:function(t){e.isShowDetail=t},expression:"isShowDetail"}})],1),s(C.A,{staticClass:"mb-0"},[s(d.A,{attrs:{"prepend-icon":"mdi-camera",disabled:!e.isShowDetail,label:"キャプチャ用モード","hide-details":""},model:{value:e.isCaptureMode,callback:function(t){e.isCaptureMode=t},expression:"isCaptureMode"}})],1),s(C.A,{staticClass:"mb-0"},[s(d.A,{attrs:{"prepend-icon":"mdi-play-circle-outline",disabled:!e.isShowDetail||!e.isCaptureMode||e.isImageMode,label:"譜面プレビュー用","hide-details":""},model:{value:e.isPreviewMode,callback:function(t){e.isPreviewMode=t},expression:"isPreviewMode"}})],1),s(C.A,{staticClass:"mb-0"},[s(d.A,{attrs:{"prepend-icon":"mdi-image",disabled:!e.isShowDetail||!e.isCaptureMode||e.isPreviewMode,label:"譜面画像生成用","hide-details":""},model:{value:e.isImageMode,callback:function(t){e.isImageMode=t},expression:"isImageMode"}})],1),s(C.A,[s(d.A,{attrs:{"prepend-icon":"mdi-stop-circle",label:"譜面停止をシミュレート"},model:{value:e.isSimulateStop,callback:function(t){e.isSimulateStop=t},expression:"isSimulateStop"}})],1),s("h3",[e._v("選択ノーツ（選択中："+e._s(e.selectionNumber)+"個）")]),s(C.A,{staticClass:"py-2",attrs:{align:"center"}},[s(r.A,{attrs:{color:"primary",text:""},on:{click:function(t){e.dialog.batchcheck=!0}}},[s(A.A,{attrs:{left:""}},[e._v("mdi-checkbox-marked-circle-outline")]),e._v(" ノーツの一括選択 ")],1),s(r.A,{attrs:{color:"warning",text:""},on:{click:e.selectionClear}},[s(A.A,{attrs:{left:""}},[e._v("mdi-select-off")]),e._v(" すべて選択解除 ")],1),s(y.A,{attrs:{width:"500"},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on,n=t.attrs;return[s(r.A,e._g(e._b({attrs:{color:"error",text:""},on:{click:function(t){e.dialog.selectionDelete=!0}}},"v-btn",n,!1),i),[s(A.A,{attrs:{left:""}},[e._v("mdi-delete-forever")]),e._v(" 選択ノーツを削除 ")],1)]}}]),model:{value:e.dialog.selectionDelete,callback:function(t){e.$set(e.dialog,"selectionDelete",t)},expression:"dialog.selectionDelete"}},[s(l.A,[s(c.ri,{staticClass:"headline"},[e._v("確認")]),s(c.OQ,[e._v(" 本当に選択したノーツ"+e._s(e.selectionNumber)+"個をすべて削除しますか？ ")]),s(b.A),s(c.SL,[s(M.A),s(r.A,{attrs:{color:"primary",text:""},on:{click:function(t){e.dialog.selectionDelete=!1}}},[e._v(" キャンセル ")]),s(r.A,{attrs:{color:"error",text:""},on:{click:e.selectionDelete}},[e._v(" 削除する ")])],1)],1)],1),s(r.A,{attrs:{color:"primary",text:""},on:{click:function(t){e.dialog.checked=!0}}},[s(A.A,{attrs:{left:""}},[e._v("mdi-auto-fix")]),e._v(" ノーツの一括操作 ")],1)],1),s("h3",[e._v("譜面情報")]),s(C.A,{attrs:{align:"center"}},[s(p.A,[s(I.A,{attrs:{label:"オフセット",required:"",outlined:"",dense:""},model:{value:e.chartObject.info.offset,callback:function(t){e.$set(e.chartObject.info,"offset",e._n(t))},expression:"chartObject.info.offset"}})],1),s(p.A,[s(I.A,{attrs:{label:"BPM",required:"",outlined:"",dense:""},model:{value:e.chartObject.info.bpm,callback:function(t){e.$set(e.chartObject.info,"bpm",e._n(t))},expression:"chartObject.info.bpm"}})],1),s(p.A,[s(I.A,{attrs:{label:"拍子",required:"",outlined:"",dense:""},model:{value:e.chartObject.info.beat,callback:function(t){e.$set(e.chartObject.info,"beat",e._n(t))},expression:"chartObject.info.beat"}})],1),s(p.A,[s(I.A,{attrs:{label:"譜面ver",outlined:"",dense:"",disabled:""},model:{value:e.chartObject.info.version,callback:function(t){e.$set(e.chartObject.info,"version",e._n(t))},expression:"chartObject.info.version"}})],1)],1),s(C.A,[s(r.A,{attrs:{color:"primary",text:""},on:{click:function(t){e.dialog.help=!0}}},[s(A.A,{attrs:{left:""}},[e._v("mdi-help-circle")]),e._v(" 使い方 ")],1),s(r.A,{staticClass:"ml-2",attrs:{color:"primary",text:""},on:{click:function(t){e.dialog.logs=!e.dialog.logs}}},[s(A.A,{attrs:{left:""}},[e._v("mdi-message-outline")]),e._v(" メッセージログ ")],1),s(r.A,{staticClass:"ml-2",attrs:{color:"primary",text:""},on:{click:e.analyze}},[s(A.A,{attrs:{left:""}},[e._v("mdi-chart-timeline-variant")]),e._v(" 譜面分析 ")],1)],1),s(C.A,[s(r.A,{attrs:{color:"success"},on:{click:e.saveFile}},[s(A.A,{attrs:{left:""}},[e._v("mdi-content-save")]),e._v(" 名前をつけて保存 ")],1),s(r.A,{staticClass:"ml-2",attrs:{color:"success",outlined:""},on:{click:e.restoreBackup}},[s(A.A,{attrs:{left:""}},[e._v("mdi-file-restore")]),e._v(" 復元 ")],1)],1),e.dialog.logs?s(l.A,{staticClass:"mx-auto message-log",attrs:{elevation:"2",rounded:"lg"}},[s(c.ri,[s(r.A,{staticClass:"mr-4",attrs:{icon:""},on:{click:function(t){e.dialog.logs=!1}}},[s(A.A,[e._v("mdi-close")])],1),e._v(" メッセージログ ")],1),s(_.A,{attrs:{subheader:""}},e._l(e.logs.slice().reverse(),(function(t){return s(w.A,{key:t.date},[s(x.pr,[s("p",{staticClass:"mb-2 d-flex"},[s(u.A,{staticClass:"flex-shrink-0 mr-2",attrs:{label:""}},[e._v(" "+e._s(t.type)+" ")]),e._v(" "+e._s(t.message)+" ")],1),s(x.w,[e._v(" "+e._s(t.date.toLocaleString("ja-JP"))+" ")])],1)],1)})),1)],1):e._e()],1),s(y.A,{attrs:{width:"800"},model:{value:e.dialog.help,callback:function(t){e.$set(e.dialog,"help",t)},expression:"dialog.help"}},[s(l.A,{attrs:{rounded:"lg"}},[s(c.ri,{staticClass:"headline"},[e._v(" エディタの使い方 ")]),s(c.OQ,[s("a",{attrs:{target:"_blank",rel:"noopener noreferrer"}},[e._v(" エディタの使い方 ")])]),s(c.OQ,[s("a",{attrs:{href:"https://github.com/mtsgi/fumenedit/blob/master/format.md",target:"_blank",rel:"noopener noreferrer"}},[e._v(" 譜面フォーマットについて ")])])],1)],1),s(y.A,{attrs:{width:"800"},model:{value:e.dialog.analyzer,callback:function(t){e.$set(e.dialog,"analyzer",t)},expression:"dialog.analyzer"}},[s(l.A,{attrs:{rounded:"lg"}},[s(c.ri,{staticClass:"headline"},[e._v(" 譜面分析 ("+e._s(e.currentDifficulty)+") ")]),s(c.OQ,[e._v(" ノーツ数："+e._s(e.analysisData.notesCount)+" "),s("br"),e._v(" オブジェクト数："+e._s(e.currentChart.size)+" "),s("br"),e._v(" 平均密度："+e._s(e.analysisData.notesCount/e.measureData.last.measureReachTime*1e3)+"Notes / 秒 ")]),s(b.A),e.dialog.analyzer?s(L.A,{attrs:{labels:e.analysisData.trendLabels,value:e.analysisData.trendValues,gradient:["#f72047","#ffd200","#1feaea"],color:"black","line-width":"2",padding:"10",smooth:"3"}}):e._e(),e.dialog.analyzer?s(L.A,{attrs:{value:e.analysisData.otofudaNotes,color:"orange","line-width":"2",height:"10",padding:"0",smooth:"0",fill:""}}):e._e(),s(c.OQ,{staticClass:"mt-4"},[e._v(" ▲音札ノーツの位置 ")]),s(T.A,[s("thead",[s("tr",[s("th",{staticClass:"text-left"},[e._v(" 種類別ノーツ数 ")]),s("th",{staticClass:"text-left"},[e._v(" 数 ")]),s("th",{staticClass:"text-left"},[e._v(" 割合 ")])])]),s("tbody",e._l(e.noteTypes,(function(t){return s("tr",{key:"note_count_"+t.value},[s("td",[e._v(e._s(t.text))]),s("td",[e._v(e._s(e.analysisData.typeCount[t.value]))]),s("td",[e._v(" "+e._s([1,2,3,4,5].includes(t.value)?Math.floor(e.analysisData.typeCount[t.value]/e.analysisData.notesCount*1e4)/100+"％":"－")+" ")])])})),0)])],1)],1),s(y.A,{attrs:{width:"800"},model:{value:e.dialog.checked,callback:function(t){e.$set(e.dialog,"checked",t)},expression:"dialog.checked"}},[s(l.A,{attrs:{rounded:"lg"}},[s(c.ri,[s(A.A,{attrs:{left:""}},[e._v("mdi-auto-fix")]),e._v(" 選択ノーツへの一括操作 "),s(M.A),s(r.A,{attrs:{icon:"",right:""},on:{click:function(t){e.dialog.checked=!1}}},[s(A.A,[e._v("mdi-close")])],1)],1),s(b.A),s(c.ri,[e._v(" 種別の変更 ")]),s(c.OQ,[s("p",[e._v(" 選択したノーツ(ロングノーツと音札ノーツを除く)を特定の種別に一括で変更します。 ")]),s(C.A,{staticClass:"mx-1",attrs:{align:"center"}},[s(I.A,{attrs:{type:"number",min:"1",max:"99",prefix:"Type：",outlined:"",dense:"","hide-details":""},model:{value:e.selectionTypeTo,callback:function(t){e.selectionTypeTo=e._n(t)},expression:"selectionTypeTo"}}),s(r.A,{staticClass:"ml-4",attrs:{color:"primary"},on:{click:function(t){return e.selectionChangeType(e.selectionTypeTo)}}},[s(A.A,{attrs:{left:""}},[e._v("mdi-auto-fix")]),e._v(" 選択ノーツを全て種別変更 ")],1)],1)],1),s(b.A),s(c.ri,[e._v(" レーンの変更 ")]),s(c.OQ,[s("p",[e._v(" 選択したノーツ(ロングノーツと音札ノーツを除く)を特定のレーンに一括で移動します。(選択範囲、または対象レーンに対して)同時押しを含む範囲に対して実行すると重複が発生します。 ")]),s(C.A,{staticClass:"mx-1",attrs:{align:"center"}},[s(I.A,{attrs:{type:"number",min:"1",max:"5",prefix:"Lane：",outlined:"",dense:"","hide-details":""},model:{value:e.selectionLaneTo,callback:function(t){e.selectionLaneTo=e._n(t)},expression:"selectionLaneTo"}}),s(r.A,{staticClass:"ml-4",attrs:{color:"primary"},on:{click:function(t){return e.selectionChangeLane(e.selectionLaneTo)}}},[s(A.A,{attrs:{left:""}},[e._v("mdi-auto-fix")]),e._v(" 選択ノーツを全てレーン移動 ")],1)],1)],1),s(c.OQ,[s("p",[e._v(" 選択したノーツ(ロングノーツと音札ノーツを除く)のそれぞれのレーンを1～5の範囲内で加算または減算します。入力は「－4」～「＋4」の範囲。 ")]),s(C.A,{staticClass:"mx-1",attrs:{align:"center"}},[s(I.A,{attrs:{type:"number",min:"-4",max:"4",prefix:"値：",outlined:"",dense:"","hide-details":""},model:{value:e.selectionLaneAddition,callback:function(t){e.selectionLaneAddition=e._n(t)},expression:"selectionLaneAddition"}}),s(r.A,{staticClass:"ml-4",attrs:{color:"primary"},on:{click:function(t){return e.selectionAddLane(e.selectionLaneAddition)}}},[s(A.A,{attrs:{left:""}},[e._v("mdi-auto-fix")]),e._v(" 各選択ノーツのレーンを加算／減算 ")],1)],1)],1),s(b.A),s(c.ri,[e._v(" 小節移動 ")]),s(c.OQ,[s("p",[e._v(" 選択したノーツの配置小節位置を加算または減算します。入力は正または負の整数。 ")]),s(C.A,{staticClass:"mx-1",attrs:{align:"center"}},[s(I.A,{attrs:{type:"number",min:"-4",max:"4",prefix:"値：",outlined:"",dense:"","hide-details":""},model:{value:e.selectionMeasureAddition,callback:function(t){e.selectionMeasureAddition=e._n(t)},expression:"selectionMeasureAddition"}}),s(r.A,{staticClass:"ml-4",attrs:{color:"primary"},on:{click:function(t){return e.selectionAddMeasure(e.selectionMeasureAddition)}}},[s(A.A,{attrs:{left:""}},[e._v("mdi-auto-fix")]),e._v(" 選択ノーツの小節を加算／減算 ")],1)],1)],1)],1)],1),s(y.A,{attrs:{width:"800"},model:{value:e.dialog.batchcheck,callback:function(t){e.$set(e.dialog,"batchcheck",t)},expression:"dialog.batchcheck"}},[s(l.A,{attrs:{rounded:"lg"}},[s(c.ri,[s(A.A,{attrs:{left:""}},[e._v("mdi-checkbox-marked-circle-outline")]),e._v(" ノーツの一括選択 "),s(M.A),s(r.A,{attrs:{icon:"",right:""},on:{click:function(t){e.dialog.batchcheck=!1}}},[s(A.A,[e._v("mdi-close")])],1)],1),s(b.A),s(c.ri,[e._v(" 対象Type ")]),s(c.OQ,[s("p",[e._v(" 対象Typeに合致するノーツを選択対象に加えます。 "),s("a",{on:{click:function(t){e.batchSelectTypes=e.noteTypes.map((function(e){return e.value}))}}},[e._v(" すべて選択 ")]),e._v(" ・ "),s("a",{on:{click:function(t){e.batchSelectTypes=[]}}},[e._v("すべて解除")])]),e._l(e.noteTypes,(function(t){return s(d.A,{key:"batch-select-type_"+t.value,staticClass:"d-inline-block mr-4",attrs:{label:t.text,value:t.value,"hide-details":""},model:{value:e.batchSelectTypes,callback:function(t){e.batchSelectTypes=t},expression:"batchSelectTypes"}})}))],2),s(b.A),s(c.ri,[e._v(" 対象小節 ")]),s(c.OQ,[s("p",[e._v(" 対象小節の範囲内のノーツを選択対象に加えます。終了小節を0にすると譜面の最後までを対象とします。 ")]),s(C.A,{staticClass:"mx-1",attrs:{align:"center"}},[s(I.A,{staticClass:"mr-4",attrs:{type:"number",min:"0",prefix:"開始：",suffix:"小節",outlined:"",dense:"","hide-details":""},model:{value:e.batchSelectStart,callback:function(t){e.batchSelectStart=e._n(t)},expression:"batchSelectStart"}}),s(I.A,{attrs:{type:"number",min:"0",prefix:"終了：",suffix:"小節",outlined:"",dense:"","hide-details":""},model:{value:e.batchSelectEnd,callback:function(t){e.batchSelectEnd=e._n(t)},expression:"batchSelectEnd"}})],1)],1),s(c.OQ,[s("p",[e._v("予測される選択個数："+e._s(e.batchSelectTarget.size))])]),s(c.SL,[s(M.A),s(r.A,{attrs:{color:"primary"},on:{click:e.batchSelect}},[s(A.A,{attrs:{left:""}},[e._v("mdi-checkbox-marked-circle-outline")]),e._v(" すべて選択する ")],1)],1)],1)],1),s(P.A,{attrs:{rounded:"lg",vertical:""},scopedSlots:e._u([{key:"action",fn:function(t){var i=t.attrs;return[s(r.A,e._b({attrs:{color:"error",text:""},on:{click:function(t){e.snackbar=!1}}},"v-btn",i,!1),[e._v(" 閉じる ")])]}}]),model:{value:e.snackbar,callback:function(t){e.snackbar=t},expression:"snackbar"}},[e._v(" "+e._s(e.snackbarText)+" ")])],1)},z=[],R=(s(4114),s(8992),s(4520),s(2577),s(1454),s(4603),s(7566),s(8721),s(4839),s(1117)),K=s(2822),q=s(8461),V=s(4519),Q=s(9366),U=s(2006),J=s(9093),W=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[e.isObjectBasedPreview?s("div",{staticClass:"object-based-preview",style:{position:"relative"}},e._l(e.measureData,(function(t){return s("ObjectBasedMeasure",{key:"measure_"+t.measure,attrs:{measure:t,notes:e.getMeasureNotes(t.measure),currentDifficulty:e.currentDifficulty}})})),1):s("div",{ref:"preview",staticClass:"preview",class:{detail:e.isShowDetail,capture_mode:e.isCaptureMode,preview_mode:e.isPreviewMode,image_mode:e.isImageMode,checkbox:e.isShowCheckbox},style:{position:e.isPreviewing?"fixed":"relative",height:e.entireHeight+"px",marginBottom:e.lift+"px",transform:0===e.drawOffset?null:"translateY("+e.drawOffset+"px)"}},[e._l(e.measureData,(function(t){return s("MeasureComponent",{key:"measure_"+t.measure,attrs:{measure:t,notes:e.getMeasureNotes(t.measure),currentDifficulty:e.currentDifficulty}})})),e._l(e.longNotes,(function(t,i){return s("LongNote",{key:"longnote_"+i,attrs:{note:t,measureData:e.measureData}})})),e.appendNote?s("NoteShadow",{attrs:{note:e.appendNote,measureData:e.measureData}}):e._e(),e._l(e.preAppendNotes,(function(t,i){return s("NoteShadow",{key:"shadow_"+t.measure+"_"+i,attrs:{note:t,measureData:e.measureData,isPreAppend:!0}})}))],2),s("div",{directives:[{name:"show",rawName:"v-show",value:!e.isObjectBasedPreview&&!e.isImageMode,expression:"!isObjectBasedPreview && !isImageMode"}],ref:"LEDLeft",staticClass:"led left"}),s("div",{directives:[{name:"show",rawName:"v-show",value:!e.isObjectBasedPreview&&!e.isImageMode,expression:"!isObjectBasedPreview && !isImageMode"}],ref:"LEDRight",staticClass:"led right"}),!e.isObjectBasedPreview&&e.isPreviewMode?s("div",{ref:"LEDLeftShadow",staticClass:"led left -s"}):e._e(),!e.isObjectBasedPreview&&e.isPreviewMode?s("div",{ref:"LEDRightShadow",staticClass:"led right -s"}):e._e(),s("div",{staticClass:"control"},[s(Q.A,{attrs:{accordionn:"",tile:""}},[s(K.A,[s(V.A,[s(r.A,{staticClass:"mr-1",attrs:{outlined:"",color:"success",disabled:e.isPreviewing||e.isObjectBasedPreview},on:{click:function(t){return t.stopPropagation(),e.previewStart(t)}}},[s(A.A,{attrs:{left:""}},[e._v("mdi-play")]),e._v(" 再生 ")],1),s(r.A,{staticClass:"ml-2 mr-2",attrs:{outlined:"",color:"error"},on:{click:function(t){return t.stopPropagation(),e.previewStop(t)}}},[s(A.A,{attrs:{left:""}},[e._v("mdi-stop")]),e._v(" 停止 ")],1)],1),s(q.A,[s(I.A,{staticClass:"mb-4",attrs:{"hide-details":"","prepend-icon":"mdi-numeric-0-box-multiple-outline",label:"再生開始小節",suffix:"小節から",outlined:"",dense:""},model:{value:e.startFrom,callback:function(t){e.startFrom=e._n(t)},expression:"startFrom"}}),s("h4",{staticClass:"my-2"},[s(A.A,[e._v("mdi-music-note")]),e._v(" 表示とサウンド ")],1),s(d.A,{staticClass:"mt-2",attrs:{label:"チェックボックスを表示","hide-details":""},model:{value:e.isShowCheckbox,callback:function(t){e.isShowCheckbox=t},expression:"isShowCheckbox"}}),s(d.A,{staticClass:"mt-2",attrs:{label:"打鍵音を再生 (β)","hide-details":""},model:{value:e.isPlayKeySound,callback:function(t){e.isPlayKeySound=t},expression:"isPlayKeySound"}}),s(d.A,{staticClass:"mt-2",attrs:{label:"LN終点音を再生 (α)","hide-details":""},model:{value:e.isPlayKeySoundEnd,callback:function(t){e.isPlayKeySoundEnd=t},expression:"isPlayKeySoundEnd"}}),s(d.A,{staticClass:"mt-2",attrs:{label:"キービームとコンボを表示","persistent-hint":"",hint:"以下2つはこの機能が有効でない場合効果がありません"},model:{value:e.isShowKeybeam,callback:function(t){e.isShowKeybeam=t},expression:"isShowKeybeam"}}),s(d.A,{staticClass:"mt-2 ml-6",attrs:{disabled:!e.isShowKeybeam,label:"フリックエフェクト (β)","hide-details":""},model:{value:e.isShowFlickEffect,callback:function(t){e.isShowFlickEffect=t},expression:"isShowFlickEffect"}}),s(d.A,{staticClass:"mt-2 ml-6",attrs:{disabled:!e.isShowKeybeam,label:"LeapMotion補助線をシミュレート (α)","hide-details":""},model:{value:e.isShowHandguide,callback:function(t){e.isShowHandguide=t},expression:"isShowHandguide"}}),s(d.A,{staticClass:"mt-2",attrs:{label:"LED制御をシミュレート (β)","hide-details":""},model:{value:e.isSimulateLED,callback:function(t){e.isSimulateLED=t},expression:"isSimulateLED"}}),s(d.A,{staticClass:"mt-2",attrs:{label:"小節ガイド音を再生","hide-details":""},model:{value:e.isPlayGuide,callback:function(t){e.isPlayGuide=t},expression:"isPlayGuide"}}),s(J.A,{attrs:{label:"Object表示モード"},model:{value:e.isObjectBasedPreview,callback:function(t){e.isObjectBasedPreview=t},expression:"isObjectBasedPreview"}}),s("h4",{staticClass:"my-4"},[s(A.A,[e._v("mdi-tune")]),e._v(" 再生オプション ")],1),s(I.A,{staticClass:"my-2",attrs:{hint:"判定ラインを上に押し上げます","persistent-hint":"","append-icon":"mdi-arrow-collapse-up",label:"LIFT",outlined:"",dense:""},model:{value:e.lift,callback:function(t){e.lift=e._n(t)},expression:"lift"}}),s(I.A,{staticClass:"mb-2",attrs:{hint:"譜面領域上部を隠します","persistent-hint":"","append-icon":"mdi-arrow-collapse-down",label:"SUDDEN",outlined:"",dense:""},model:{value:e.sudden,callback:function(t){e.sudden=e._n(t)},expression:"sudden"}}),s(I.A,{attrs:{hint:"譜面領域下部を隠します","persistent-hint":"","append-icon":"mdi-eye-off",label:"HIDDEN",outlined:"",dense:""},model:{value:e.hidden,callback:function(t){e.hidden=e._n(t)},expression:"hidden"}}),s("h4",{staticClass:"my-4"},[s(A.A,[e._v("mdi-tune")]),e._v(" 詳細設定 ")],1),s(I.A,{staticClass:"mb-2",attrs:{hint:"判定ラインの上側に移動します","persistent-hint":"","append-icon":"mdi-arrow-up",label:"コンボ表示位置",outlined:"",dense:""},model:{value:e.comboOffset,callback:function(t){e.comboOffset=e._n(t)},expression:"comboOffset"}}),s(I.A,{staticClass:"mb-2",attrs:{hint:"描画のみ位置をずらします","persistent-hint":"","append-icon":"mdi-arrow-expand-up",label:"判定位置調整(β)",outlined:"",dense:""},model:{value:e.drawOffset,callback:function(t){e.drawOffset=e._n(t)},expression:"drawOffset"}}),s(I.A,{attrs:{"append-icon":"mdi-arrow-expand-vertical",label:"キービームの長さ",suffix:"px",outlined:"","hide-details":"",dense:""},model:{value:e.keybeamLength,callback:function(t){e.keybeamLength=e._n(t)},expression:"keybeamLength"}}),s(U.A,[e._v("コンボ数の透明度")]),s(D.A,{attrs:{"hide-details":"",max:"100",min:"0","thumb-label":"always"},model:{value:e.comboOpacity,callback:function(t){e.comboOpacity=e._n(t)},expression:"comboOpacity"}})],1)],1)],1)],1),s("div",{directives:[{name:"show",rawName:"v-show",value:e.isPreviewing,expression:"isPreviewing"}],staticClass:"lift",style:{height:e.lift+"px"}}),s("div",{directives:[{name:"show",rawName:"v-show",value:e.isPreviewing,expression:"isPreviewing"}],staticClass:"sudden",style:{height:e.sudden+"px"}}),s("div",{directives:[{name:"show",rawName:"v-show",value:e.isPreviewing,expression:"isPreviewing"}],staticClass:"hidden",style:{height:e.hidden+"px",bottom:e.lift-2+"px"}}),s("div",{directives:[{name:"show",rawName:"v-show",value:e.isPreviewing&&e.isShowKeybeam,expression:"isPreviewing && isShowKeybeam"}],staticClass:"combo",style:{opacity:String(Number(e.comboOpacity)/100),bottom:Number(e.lift)+Number(e.comboOffset)+"px"}},[s("strong",{ref:"currentCombo"},[e._v("0")]),e._v(" COMBO ")]),s("div",{directives:[{name:"show",rawName:"v-show",value:e.isShowKeybeam,expression:"isShowKeybeam"}],ref:"keybeams",staticClass:"keybeams",style:{bottom:e.lift-2+"px",height:e.keybeamLength+"px"}},e._l(6,(function(e){return s("div",{key:"keybeam"+e})})),0),s("div",{directives:[{name:"show",rawName:"v-show",value:e.isPreviewing&&e.isShowHandguide,expression:"isPreviewing && isShowHandguide"}],ref:"handguide",staticClass:"handguide",style:{bottom:e.lift-1+"px"}})])},G=[],Y=(s(3949),s(354)),Z=s.n(Y),X=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"measure",class:{hiddenControl:e.notes.find((function(e){return 95===e.type&&0===e.position})),isStop:e.notes.find((function(e){return 92===e.type}))},style:{bottom:e.measure.measurePositionBottom+"px",height:e.measure.measureHeight+"px"}},[s(k.A,{attrs:{"offset-y":"","close-on-content-click":!1,rounded:"lg"},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on,n=t.attrs;return[s(r.A,e._g(e._b({attrs:{dark:"",icon:""},on:{click:function(t){e.copyToDifficulty=e.currentDifficulty,e.copyToMeasure=e.measure.measure}}},"v-btn",n,!1),i),[s(A.A,[e._v("mdi-dots-vertical")])],1)]}}])},[s(_.A,[s(w.A,[s(x.UZ,[s("strong",[e._v(e._s(e.measure.measure)+" 小節")]),e._v(" （"+e._s(e.notes.size)+" OBJ） ")])],1),s(w.A,[e._v(" 到達時間："+e._s(e.measure.measureReachTime.toFixed(4))+"ms ")]),s(b.A),s(w.A,[s("strong",[e._v("小節内のノーツを")])]),s(w.A,{staticClass:"px-0 mx-2"},[s(r.A,{attrs:{color:"primary",text:"",dense:""},on:{click:e.selectAll}},[s(A.A,{attrs:{left:""}},[e._v("mdi-select")]),e._v(" 全て選択 ")],1),s(r.A,{attrs:{color:"warning",text:"",dense:""},on:{click:e.clearAll}},[s(A.A,{attrs:{left:""}},[e._v("mdi-select-off")]),e._v(" 全て選択解除 ")],1)],1),s(b.A),s(w.A,[s("strong",[e._v(e._s(e.measure.measure)+"小節内のノーツを対象に")])]),s(w.A,{staticClass:"px-0 mx-2"},[s(O.A,{attrs:{items:e.difficulties,label:"複製先難易度",align:"left","hide-details":"",outlined:"",dense:"","menu-props":{rounded:"lg"}},model:{value:e.copyToDifficulty,callback:function(t){e.copyToDifficulty=t},expression:"copyToDifficulty"}})],1),s(w.A,{staticClass:"px-0 mx-2"},[s(I.A,{attrs:{"hide-details":"",label:"複製先小節",outlined:"",dense:""},model:{value:e.copyToMeasure,callback:function(t){e.copyToMeasure=e._n(t)},expression:"copyToMeasure"}})],1),s(w.A,{staticClass:"px-0 mx-2"},[e._v(" 小節に "),s(M.A),s(r.A,{attrs:{color:"primary",text:"",dense:""},on:{click:e.copyAll}},[s(A.A,{attrs:{left:""}},[e._v("mdi-content-copy")]),e._v(" 複製 ")],1),s(r.A,{attrs:{color:"warning",text:"",dense:""},on:{click:e.moveAll}},[s(A.A,{attrs:{left:""}},[e._v("mdi-content-cut")]),e._v(" 移動 ")],1)],1),s(w.A,{staticClass:"px-0 mx-2 mb-2"},[e._v(" Option： "),s(S.A,{attrs:{"hide-details":""},model:{value:e.copyOrMoveOnlySelected,callback:function(t){e.copyOrMoveOnlySelected=t},expression:"copyOrMoveOnlySelected"}},[s(N.A,{attrs:{label:"すべてのノーツを対象",value:!1}}),s(N.A,{attrs:{label:"チェック済みのみ対象",value:!0}})],1)],1)],1)],1),e._l(4,(function(t){return s("span",{key:t,staticClass:"measure__separator",style:{left:60*t-1+"px",height:e.measure.measureHeight+"px"}})})),s("span",{staticClass:"measure__number",domProps:{textContent:e._s(e.measure.measure)}}),e._l(e.dispNotes,(function(t,i){return s("Note",{key:"note_"+e.measure.measure+"_"+i,attrs:{note:t,measure:e.measure,currentChart:e.notes}})}))],2)},ee=[],te=s(7402),se=s(4794),ie=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s(k.A,{attrs:{"close-on-click":!1,"close-on-content-click":!1,absolute:"",left:"","nudge-left":50,"max-width":240},scopedSlots:e._u([{key:"activator",fn:function(t){var i,n=t.on,o=t.attrs;return[s("span",e._g(e._b({staticClass:"note",class:(i={},i["type"+e.drawType]=!0,i.isDummy=90===e.note.type,i.hidden=e.isHiddenControl,i.menu=e.menu,i),style:{left:e.positionLeft+"px",bottom:e.positionBottom+"px",width:e.noteWidth+"px",background:e.dispColor}},"span",o,!1),n),[94===e.drawType?s("img",{style:{height:e.measure.measureHeight*Number(e.drawOptions[2])+"px"},attrs:{src:String(e.drawOptions[0]).startsWith("texture")?"https://db.otofuda.com/"+e.drawOptions[0]:e.drawOptions[0],alt:"texture"}}):e._e(),100===e.drawType?s(A.A,{staticClass:"mt-2",attrs:{color:"warning"}},[e._v(" mdi-comment ")]):e._e(),100===e.drawType?s(te.A,{staticClass:"elevation-4",attrs:{outlined:"","background-color":"amber lighten-4","hide-details":""},on:{click:function(e){e.stopPropagation()}},model:{value:e.note.option[0],callback:function(t){e.$set(e.note.option,0,t)},expression:"note.option[0]"}}):e._e(),s("input",{directives:[{name:"model",rawName:"v-model",value:e.note.isSelected,expression:"note.isSelected"}],attrs:{type:"checkbox",id:e.note.index},domProps:{checked:Array.isArray(e.note.isSelected)?e._i(e.note.isSelected,null)>-1:e.note.isSelected},on:{click:function(e){e.stopPropagation()},change:function(t){var s=e.note.isSelected,i=t.target,n=!!i.checked;if(Array.isArray(s)){var o=null,a=e._i(s,o);i.checked?a<0&&e.$set(e.note,"isSelected",s.concat([o])):a>-1&&e.$set(e.note,"isSelected",s.slice(0,a).concat(s.slice(a+1)))}else e.$set(e.note,"isSelected",n)}}}),e.getDuplicated?s(se.A,{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on,n=t.attrs;return[s(A.A,e._g(e._b({staticClass:"mt-2",attrs:{color:"warning",dark:""}},"v-icon",n,!1),i),[e._v(" mdi-alert ")])]}}],null,!0)},[s("span",[e._v(e._s(e.getDuplicated)+"個の重複")])]):e._e(),e.getError?s(se.A,{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on,n=t.attrs;return[s(A.A,e._g(e._b({staticClass:"mt-2",attrs:{color:"error",dark:""}},"v-icon",n,!1),i),[e._v(" mdi-alert-circle-outline ")])]}}],null,!0)},[s("span",[e._v(e._s(e.getError))])]):e._e(),1!==e.noteSpeed?s("strong",{staticClass:"speed"},[e._v("x"+e._s(e.noteSpeed))]):e._e(),0!==e.noteOrbit?s("strong",{staticClass:"orbit"},[e._v(">"+e._s(e.noteOrbit))]):e._e(),97===e.drawType?s("strong",[e._v("BEAT "+e._s(e.note.option[0]))]):e._e(),e._v(" "+e._s(e.note.position)+"/"+e._s(e.note.split)+" "),91===e.drawType?s("strong",[e._v("SpObj")]):e._e(),92===e.drawType?s("strong",[e._v("STOP")]):e._e(),93===e.drawType?s("strong",[e._v("WARP "+e._s(e.note.option[0]))]):e._e(),98===e.drawType?s("strong",[e._v("BPM "+e._s(e.note.option[0]))]):e._e(),99===e.drawType?s("strong",[e._v("EOF")]):e._e()],1)]}}]),model:{value:e.menu,callback:function(t){e.menu=t},expression:"menu"}},[e.menu?s(l.A,{attrs:{rounded:"lg"}},[s(_.A,[s(w.A,[s(c.OQ,[e._v("#"+e._s(e.note.index)+" "+e._s(e.noteTypeName))]),s(M.A),s(r.A,{attrs:{icon:"",right:""},on:{click:function(t){e.menu=!1}}},[s(A.A,[e._v("mdi-close")])],1)],1),s(w.A,[s(C.A,[s(p.A,[s(I.A,{attrs:{value:e.note.measure,"hide-details":"",suffix:"小節",outlined:"",dense:""},on:{change:function(t){return e.note.measure=Number(t)},keydown:function(t){if(!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;t.stopPropagation(),e.menu=!1}}})],1)],1)],1),s(w.A,[s(C.A,[s(p.A,{attrs:{cols:"12",sm:"6"}},[s(I.A,{attrs:{label:"position",outlined:"",dense:"","hide-details":"",type:"number"},model:{value:e.note.position,callback:function(t){e.$set(e.note,"position",e._n(t))},expression:"note.position"}})],1),s(p.A,{attrs:{cols:"12",sm:"6"}},[s(I.A,{attrs:{label:"split",outlined:"",dense:"","hide-details":"",type:"number"},model:{value:e.note.split,callback:function(t){e.$set(e.note,"split",e._n(t))},expression:"note.split"}})],1)],1)],1),s(w.A,[e._v(" LANE "),s(M.A),s(S.A,{attrs:{row:"",disabled:e.getIsLanelessNote},model:{value:e.note.lane,callback:function(t){e.$set(e.note,"lane",e._n(t))},expression:"note.lane"}},e._l(5,(function(e){return s(N.A,{key:e,attrs:{value:e}})})),1)],1),s(w.A,[s(O.A,{attrs:{items:e.getNoteTypes,"hide-details":"",label:"ノート種別",align:"left",outlined:"",dense:"","menu-props":{rounded:"lg"}},model:{value:e.note.type,callback:function(t){e.$set(e.note,"type",t)},expression:"note.type"}})],1),e.getOptions.length>0?s(w.A,[s(c.OQ,[e._v("オプション")]),s(M.A),s(r.A,{attrs:{href:"https://github.com/otofuda/chart-types",target:"_blank",icon:"",right:""}},[s(A.A,[e._v("mdi-help")])],1)],1):e._e(),e._l(e.getOptions,(function(t,i){return s(w.A,{key:"option_"+i},[s(I.A,{attrs:{"hide-details":"",label:t.label,type:t.type,outlined:"",dense:""},model:{value:e.note.option[i],callback:function(t){e.$set(e.note.option,i,t)},expression:"note.option[i]"}})],1)}))],2),s(c.SL,[s(r.A,{attrs:{color:"primary",text:""},on:{click:e.cloneThisNote}},[s(A.A,[e._v("mdi-content-copy")])],1),s(r.A,{attrs:{color:"error",text:""},on:{click:e.deleteThisNote}},[s(A.A,{attrs:{left:""}},[e._v("mdi-delete")]),e._v(" 削除 ")],1),s(r.A,{attrs:{color:"secondary",text:""},on:{click:e.showNoteInfo}},[s(A.A,[e._v("mdi-information")])],1)],1)],1):e._e()],1)},ne=[],oe=i.A.extend({data(){return{noteTypes:[{text:"通常",value:1},{text:"ロング",value:2},{text:"左フリック",value:3},{text:"右フリック",value:4},{text:"音札",value:5},{text:"ダミー",value:90},{text:"特殊オブジェクト",value:91},{text:"譜面停止",value:92},{text:"瞬間移動",value:93},{text:"テクスチャ",value:94},{text:"区切り線",value:95},{text:"LED制御",value:96},{text:"拍子変化",value:97},{text:"BPM変化",value:98},{text:"EOF",value:99},{text:"コメント",value:100}]}},methods:{noteOptions(e){if([1,2].includes(e.type))return[{label:"speed",type:"number",desc:"Float型｜スピード(倍率)"},{label:"orbit",type:"number",desc:"Float型｜軌道(レーン幅/秒)"}];if([3,4].includes(e.type))return[{label:"width",type:"number",desc:"String型｜中心を基点とした横幅(単位：1レーンの幅)"},{label:"offsetNumer",type:"number",desc:"String型｜右側へのオフセット分数の分子"},{label:"offsetDenom",type:"number",desc:"String型｜右側へのオフセット分数の分母"},{label:"speed",type:"number",desc:"Float型｜スピード(倍率)"},{label:"orbit",type:"number",desc:"Float型｜軌道(レーン幅/秒)"}];if([5].includes(e.type))return[{label:"speed",type:"number",desc:"Float型｜スピード(倍率)"}];if(90===e.type){const t=this.noteOptions({...e,type:Number(e.option[0])});return[{label:"type",type:"number",desc:"Integer型｜擬態するノート種別(対応type: 1, 2, 3, 4, 5)"},...t]}return 91===e.type?[{label:"objectType",type:"string",desc:"String型｜表示するオブジェクトの種類"},{label:"objectName",type:"string",desc:"String型｜表示するオブジェクト名"},{label:"option",type:"string",desc:"String型｜その他のフラグ"}]:93===e.type?[{label:"beat",type:"number",desc:"Float型｜瞬間移動する小節の高さの拍子数"}]:94===e.type?[{label:"source",type:"text",desc:"String型｜画像のソース(httpまたはhttpsプロトコル)"},{label:"width",type:"number",desc:"String型｜中心を基点とした横幅(単位：1レーンの幅)"},{label:"height",type:"number",desc:"String型｜下面を基点とした高さ(単位：1小節の高さ)"},{label:"offsetNumer",type:"number",desc:"String型｜右側へのオフセット分数の分子"},{label:"offsetDenom",type:"number",desc:"String型｜右側へのオフセット分数の分母"},{label:"speed",type:"number",desc:"Float型｜スピード(倍率)"},{label:"orbit",type:"number",desc:"Float型｜軌道(レーン幅/秒)"}]:95===e.type?[{label:"length",type:"number",desc:"String型｜左面を基点とした横幅(単位：1レーンの幅)"},{label:"speed",type:"number",desc:"Float型｜スピード(倍率)"},{label:"orbit",type:"number",desc:"Float型｜軌道(レーン幅/秒)"}]:96===e.type?[{label:"red",type:"number",desc:"String型｜0-255の整数"},{label:"green",type:"number",desc:"String型｜0-255の整数"},{label:"blue",type:"number",desc:"String型｜0-255の整数"}]:97===e.type?[{label:"beat",type:"number",desc:"String型｜変化後の[n/4拍子]の分子の値"}]:98===e.type?[{label:"bpm",type:"number",desc:"String型｜変化後のBPMの値"}]:100===e.type?[{label:"comment",type:"text",desc:"String型｜コメント"}]:[]}}}),ae=i.A.extend({methods:{isDuplicated(e,t={checkPreAppend:!0,comparators:null}){const s=t.comparators||this.currentChart;if(s){const i=e.position/e.split;let n=0;return s.each((t=>{if(t.measure===e.measure&&t.lane===e.lane&&t.position/t.split===i){if(94===t.type||94===e.type)return;if([1,92,93,96,97,98].includes(t.type)&&[1,92,93,96,97,98].includes(e.type)&&t.type!==e.type)return;if([3,95].includes(t.type)&&[3,95].includes(e.type)&&t.type!==e.type)return;if([4,95].includes(t.type)&&[4,95].includes(e.type)&&t.type!==e.type)return;if([1,95].includes(t.type)&&[1,95].includes(e.type)&&t.type!==e.type)return;if(5===t.type&&2===e.type||2===t.type&&5===e.type)return;if(t.index===e.index)return;n++}})),t.checkPreAppend&&this.preAppendNotes&&this.preAppendNotes.each((t=>{if(t.measure===e.measure&&t.lane===e.lane&&t.position/t.split===i){if([3,4,94,95].includes(t.type)&&[3,4,94,95].includes(e.type)&&t.type!==e.type)return;if(5===t.type&&2===e.type||2===t.type&&5===e.type)return;n++}})),n}return 1/0},hasError(e){return e.split<=0?"splitの値は0より大きい必要があります。":e.position<0?"positionの値は0以上である必要があります。":e.position>=e.split?"positionの値はsplitの値未満である必要があります。":[-1,1,2,3,4,5].includes(e.lane)?![1,2,3,4,5,90,91,92,93,94,95,96,97,98,99,100].includes(e.type)&&"不正なノートタイプです。":"不正なノートのレーン位置です。"},getValidatedNote(e){const t=Number(e.type);let s=Number(e.lane);5===t&&(s=3),[96,97,98,99].includes(t)&&(s=-1);let i=[];return(2===e.type||90===e.type&&"2"===e.option[1])&&(i=[...e.end].map(this.getValidatedNote)),{type:t,measure:Number(e.measure),lane:s,position:Number(e.position),split:Number(e.split),option:this.getValidatedOptions(e),end:i}},getValidatedOptions(e){const t=[];return[99].includes(e.type)?t:[1,2].includes(e.type)?(e.option[0]&&(t.append(String(e.option[0])),e.option[1]&&t.append(String(e.option[1]))),t):[3,4].includes(e.type)?(t.append(e.option[0]?String(e.option[0]):"-1"),e.option[1]&&e.option[2]&&(t.append(String(e.option[1]),String(e.option[2])),e.option[3]&&(t.append(String(e.option[3])),e.option[4]&&t.append(String(e.option[4])))),t):[5].includes(e.type)?(e.option[0]&&t.append(String(e.option[0])),t):[94].includes(e.type)?(t.append(e.option[0]||"texture/202020.png"),t.append(e.option[1]?String(e.option[1]):"1"),t.append(e.option[2]?String(e.option[2]):"0.25"),e.option[3]&&e.option[4]&&t.append(String(e.option[3]),String(e.option[4])),t):[95,97,98].includes(e.type)?95===e.type&&0===e.position?["-1"]:(t.append(e.option[0]?String(e.option[0]):"-1"),t):[96].includes(e.type)?(t.append(String(e.option[0]),String(e.option[1]),String(e.option[2])),t):[100].includes(e.type)?(t.append(e.option&&e.option[0]?String(e.option[0]):""),t):[...e.option].map((e=>String(e)))},isLanelessNote(e){return[5,92,93,96,97,98,99].includes(e.type)}}}),re=i.A.extend({name:"NoteComponent",mixins:[oe,ae],inject:["deleteNotes","setAppendNoteInfo","showSnackbar"],data(){return{menu:!1}},props:{note:{type:Object,required:!0},measure:{type:Object,required:!0},currentChart:{type:Array,required:!0}},methods:{deleteThisNote(){this.deleteNotes(this.note.index),this.menu=!1},cloneThisNote(){this.setAppendNoteInfo({...this.note,option:[...this.note.option],end:[]}),this.menu=!1,this.showSnackbar("挿入ノートに同じデータをセットしました")},showNoteInfo(){this.showSnackbar(JSON.stringify(this.note,null,2))}},computed:{positionLeft(){if([1,2,95,100].includes(this.drawType))return 60*(this.note.lane-1);if([3,4].includes(this.drawType)){let e=Number(this.drawOptions[0])||3;-1===e&&(e=3);let t=60*(this.note.lane-1)+30,s=0;const i=Number(this.drawOptions[1]),n=Number(this.drawOptions[2]);return i&&n&&(s=i/n*60),t-e/2*60+s}if(94===this.drawType){let e=Number(this.drawOptions[1])||1,t=60*(this.note.lane-1)+30,s=0;return this.drawOptions[3]&&this.drawOptions[4]&&(s=Number(this.drawOptions[3])/Number(this.drawOptions[4])*60),t-e/2*60+s}return 96===this.drawType?-50:0},positionBottom(){return this.note.position/this.note.split*this.measure.measureHeight},noteWidth(){if([1,2,100].includes(this.drawType))return 60;if([3,4].includes(this.drawType)){let e=Number(this.drawOptions[0])||3;return-1===e&&(e=3),60*e}if(94===this.drawType){let e=Number(this.drawOptions[1])||1;return 60*e-1}if(95===this.drawType){let e=Number(this.drawOptions[0])||1;return-1===e&&(e=1),0===this.note.position&&(e=5),60*e}return 96===this.drawType?40:300},isHiddenControl(){return 95===this.drawType&&0===this.note.position},noteTypeName(){return this.noteTypes.find((e=>e.value===this.note.type))?.text||`不明 (type: ${this.note.type})`},dispColor(){return 96===this.drawType?-1===Number(this.drawOptions[0])&&-1===Number(this.drawOptions[1])&&-1===Number(this.drawOptions[2])?"linear-gradient(0deg, #ff5151 20%, #44a5ff 80%)":`rgb(${this.drawOptions[0]},${this.drawOptions[1]},${this.drawOptions[2]})`:null},noteSpeed(){if([1,2,5].includes(this.drawType)){if(this.drawOptions[0])return Number(this.drawOptions[0])}else if([3,4].includes(this.drawType)){if(this.drawOptions[3])return Number(this.drawOptions[3])}else if(94===this.drawType){if(this.drawOptions[5])return Number(this.drawOptions[5])}else if(95===this.drawType&&this.drawOptions[1])return Number(this.drawOptions[1]);return 1},noteOrbit(){if([1,2].includes(this.drawType)){if(this.drawOptions[1])return Number(this.drawOptions[1])}else if([3,4].includes(this.drawType)){if(this.drawOptions[4])return Number(this.drawOptions[4])}else if(94===this.drawType){if(this.drawOptions[6])return Number(this.drawOptions[6])}else if(95===this.drawType&&this.drawOptions[2])return Number(this.drawOptions[2]);return 0},drawType(){return 90===this.note.type?Number(this.note.option[0]):this.note.type},drawOptions(){return 90===this.note.type?this.note.option.slice(1):this.note.option},getDuplicated(){return this.isDuplicated(this.note)},getError(){return this.hasError(this.note)},getOptions(){return this.noteOptions(this.note)},getNoteTypes(){return this.noteTypes},getIsLanelessNote(){return this.isLanelessNote(this.note)}}}),le=re,ce=s(1656),de=(0,ce.A)(le,ie,ne,!1,null,"d4cccf06",null),ue=de.exports,pe=i.A.extend({name:"MeasureComponent",inject:["deleteNotes","appendNotes","showSnackbar","getMovedNote","copyNotesToDifficulty"],props:{notes:{type:Array,default:()=>[]},measure:{type:Object,required:!0},currentDifficulty:{type:String,default:"easy"}},data(){return{difficulties:["raku","easy","normal","hard","extra"],copyToDifficulty:this.currentDifficulty,copyToMeasure:0,copyOrMoveOnlySelected:!1}},methods:{selectAll(){this.notes.each((e=>{e.isSelected=!0}))},clearAll(){this.notes.each((e=>{e.isSelected=!1}))},copyAll(){let e=this.notes.filter((e=>2!==e.type));this.copyOrMoveOnlySelected&&(e=e.filter((e=>e.isSelected))),this.currentDifficulty===this.copyToDifficulty?(this.appendNotes(...e.map((e=>this.getMovedNote({...e},this.copyToMeasure)))),this.showSnackbar(`対象の${e.size}ノーツに対して、${this.measure.measure}小節 => ${this.copyToMeasure}小節へ複製処理を行いました（ロングノーツを除く）`)):this.copyNotesToDifficulty(this.copyToDifficulty,...e.map((e=>this.getMovedNote({...e},this.copyToMeasure))))},moveAll(){let e=this.notes.filter((e=>2!==e.type));this.copyOrMoveOnlySelected&&(e=e.filter((e=>e.isSelected)));const t=e.map((e=>e.index));this.currentDifficulty===this.copyToDifficulty?(this.appendNotes(...e.map((e=>this.getMovedNote({...e},this.copyToMeasure)))),this.deleteNotes(...t),this.showSnackbar(`対象の${e.size}ノーツに対して、${this.measure.measure}小節 => ${this.copyToMeasure}小節へ移動処理を行いました（ロングノーツを除く）`)):(this.copyNotesToDifficulty(this.copyToDifficulty,...e.map((e=>this.getMovedNote({...e},this.copyToMeasure)))),this.deleteNotes(...t))}},computed:{dispNotes(){return this.notes.filter((e=>2!==e.type&&!(90===e.type&&"2"===e.option[0])))}},components:{Note:ue}}),he=pe,me=(0,ce.A)(he,X,ee,!1,null,"4a600510",null),fe=me.exports,ye=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"object-based-measure"},[s("h3",[e._v(" "+e._s(e.measure.measure)+"小節 "),s("span",[e._v(" "+e._s(e.measure.measureBeat)+"/4拍子・"+e._s(e.measure.measureBpm)+"BPM ")])]),s(Q.A,{attrs:{dark:""}},e._l(e.notes,(function(t,i){return s(K.A,{key:"note_"+e.measure.measure+"_"+i},[s(V.A,{scopedSlots:e._u([e.hasError(t)?{key:"actions",fn:function(){return[s(A.A,{attrs:{color:"error"}},[e._v(" mdi-alert-circle ")])]},proxy:!0}:null],null,!0)},[e._v(" #"+e._s(t.index)+" "+e._s(e.noteTypeName(t))+" "),s("span",[e._v("（"+e._s(t.position)+"/"+e._s(t.split)+"）")])]),s(q.A,[e.hasError(t)?s(n.A,{attrs:{type:"error"}},[e._v(" "+e._s(e.hasError(t))+" ")]):e._e(),s(I.A,{attrs:{value:t.measure,label:"小節",outlined:"",dense:"","hide-details":"",type:"number"},on:{change:function(e){return t.measure=Number(e)},keydown:function(t){if(!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;t.stopPropagation(),e.menu=!1}}}),s(C.A,[s(p.A,{attrs:{cols:"12",sm:"6"}},[s(O.A,{attrs:{items:e.noteTypes,"hide-details":"",label:"ノート種別",align:"left",outlined:"",dense:""},model:{value:t.type,callback:function(s){e.$set(t,"type",s)},expression:"note.type"}})],1),s(p.A,{attrs:{cols:"12",sm:"6"}},[s(I.A,{attrs:{label:"lane",outlined:"",dense:"","hide-details":"",type:"number"},model:{value:t.lane,callback:function(s){e.$set(t,"lane",e._n(s))},expression:"note.lane"}})],1)],1),s(C.A,[s(p.A,{attrs:{cols:"12",sm:"6"}},[s(I.A,{attrs:{label:"position",outlined:"",dense:"","hide-details":"",type:"number"},model:{value:t.position,callback:function(s){e.$set(t,"position",e._n(s))},expression:"note.position"}})],1),s(p.A,{attrs:{cols:"12",sm:"6"}},[s(I.A,{attrs:{label:"split",outlined:"",dense:"","hide-details":"",type:"number"},model:{value:t.split,callback:function(s){e.$set(t,"split",e._n(s))},expression:"note.split"}})],1)],1),e._l(e.noteOptions(t),(function(i,n){return s("row",{key:"option_"+n},[s(I.A,{staticClass:"mb-4",attrs:{"hide-details":"",label:i.label,type:i.type,outlined:"",dense:""},model:{value:t.option[n],callback:function(s){e.$set(t.option,n,s)},expression:"note.option[i]"}})],1)})),2===t.type?s("div",{staticClass:"object-based-measure__children"},[s("ObjectBasedMeasure",{attrs:{measure:Object.assign({},e.measure,{measure:"[終点]",measureBeat:"-",measureBpm:"-"}),notes:t.end}})],1):e._e(),s(d.A,{directives:[{name:"show",rawName:"v-show",value:void 0!==t.isSelected,expression:"note.isSelected !== undefined"}],attrs:{label:"選択"},model:{value:t.isSelected,callback:function(s){e.$set(t,"isSelected",s)},expression:"note.isSelected"}}),s(r.A,{attrs:{color:"error",text:""},on:{click:function(s){return e.deleteNote(t)}}},[s(A.A,{attrs:{left:""}},[e._v("mdi-delete")]),e._v(" 削除 ")],1),s(r.A,{attrs:{text:""},on:{click:function(s){e.showSnackbar(JSON.stringify(t,null,2))}}},[s(A.A,[e._v("mdi-information")]),e._v(" ノート情報表示 ")],1)],2)],1)})),1)],1)},be=[],ve=i.A.extend({name:"ObjectBasedMeasure",mixins:[oe,ae],inject:["deleteNotes","showSnackbar"],props:{notes:{type:Array,required:!1,default:()=>[]},measure:{type:Object,required:!0},measureData:{type:Array,default:()=>[]},currentDifficulty:{type:String,default:"easy"}},methods:{deleteNote(e){this.deleteNotes(e.index)},noteTypeName(e){const t=this.noteTypes;return 90!==e.type?t.find((t=>t.value===e.type))?.text||"---":"ダミー "+t.find((t=>String(t.value)===e.option[0]))?.text}}}),Ae=ve,ge=(0,ce.A)(Ae,ye,be,!1,null,"49ca2ec7",null),_e=ge.exports,we=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s(k.A,{attrs:{"close-on-click":!1,"close-on-content-click":!1,absolute:"",left:"","max-width":240},scopedSlots:e._u([{key:"activator",fn:function(t){var i,n=t.on,o=t.attrs;return[s("span",e._g(e._b({staticClass:"note",class:(i={},i["type"+e.drawType]=!0,i.isDummy=90===e.note.type,i),style:{left:e.getLeft(e.note)+"px",bottom:e.getBottom(e.note)+"px",width:e.getWidth(e.note)+"px"}},"span",o,!1),n),[s("input",{directives:[{name:"model",rawName:"v-model",value:e.note.isSelected,expression:"note.isSelected"}],attrs:{type:"checkbox",id:e.note.index},domProps:{checked:Array.isArray(e.note.isSelected)?e._i(e.note.isSelected,null)>-1:e.note.isSelected},on:{click:function(e){e.stopPropagation()},change:function(t){var s=e.note.isSelected,i=t.target,n=!!i.checked;if(Array.isArray(s)){var o=null,a=e._i(s,o);i.checked?a<0&&e.$set(e.note,"isSelected",s.concat([o])):a>-1&&e.$set(e.note,"isSelected",s.slice(0,a).concat(s.slice(a+1)))}else e.$set(e.note,"isSelected",n)}}}),e._v(e._s(e.note.position)+"/"+e._s(e.note.split))]),e._l(e.note.end,(function(t,i){return s("div",{key:i},[s("span",{staticClass:"note",class:"type"+t.type,style:{left:e.getLeft(t)+"px",bottom:e.getBottom(t)+"px",width:e.getWidth(t)+"px"}},[e._v(e._s(t.position)+"/"+e._s(t.split))]),s("i",e._g(e._b({staticClass:"note-hold",style:{bottom:e.getBottom(e.note)+"px",left:e.getLeft(t)+"px",height:e.getBottom(t)-e.getBottom(e.note)+"px"}},"i",o,!1),n))])}))]}}]),model:{value:e.menu,callback:function(t){e.menu=t},expression:"menu"}},[e.menu?s(l.A,{attrs:{rounded:"lg"}},[s(_.A,[s(w.A,[s(c.OQ,[e._v(" #"+e._s(e.note.index)+" ロング "+e._s(90===e.note.type?"(ダミー)":"")+" ")]),s(M.A),s(r.A,{attrs:{icon:"",right:""},on:{click:function(t){e.menu=!1}}},[s(A.A,[e._v("mdi-close")])],1)],1),s(c.OQ,{staticClass:"ml-4"},[e._v("始点")]),s(w.A,[s(C.A,[s(p.A,[s(I.A,{attrs:{value:e.note.measure,"hide-details":"",suffix:"小節",outlined:"",dense:""},on:{change:function(t){return e.note.measure=Number(t)}}})],1)],1)],1),s(w.A,[s(C.A,[s(p.A,{attrs:{cols:"12",sm:"6"}},[s(I.A,{attrs:{label:"position",outlined:"",dense:"","hide-details":"",type:"number"},model:{value:e.note.position,callback:function(t){e.$set(e.note,"position",t)},expression:"note.position"}})],1),s(p.A,{attrs:{cols:"12",sm:"6"}},[s(I.A,{attrs:{label:"split",outlined:"",dense:"","hide-details":"",type:"number"},model:{value:e.note.split,callback:function(t){e.$set(e.note,"split",t)},expression:"note.split"}})],1)],1)],1),s(w.A,[e._v(" LANE "),s(M.A),s(S.A,{attrs:{row:"","hide-details":""},model:{value:e.note.lane,callback:function(t){e.$set(e.note,"lane",t)},expression:"note.lane"}},e._l(5,(function(e){return s(N.A,{key:e,attrs:{value:e}})})),1)],1),e._l(e.note.end,(function(t,i){return s("div",{key:"longnote_end_"+e.note.index+"_"+i},[s(b.A),s(c.OQ,{staticClass:"ml-4 mt-2"},[e._v("終点"+e._s(i))]),s(w.A,[s(C.A,[s(p.A,[s(I.A,{attrs:{value:t.measure,"hide-details":"",suffix:"小節",outlined:"",dense:""},on:{change:function(e){return t.measure=Number(e)}}})],1)],1)],1),s(w.A,[e._v(" LANE "),s(M.A),s(S.A,{attrs:{row:"","hide-details":""},model:{value:t.lane,callback:function(s){e.$set(t,"lane",s)},expression:"end.lane"}},e._l(5,(function(e){return s(N.A,{key:e,attrs:{value:e}})})),1)],1),s(w.A,[s(C.A,[s(p.A,{attrs:{cols:"12",sm:"6"}},[s(I.A,{attrs:{label:"position",outlined:"",dense:"","hide-details":"",type:"number"},model:{value:t.position,callback:function(s){e.$set(t,"position",s)},expression:"end.position"}})],1),s(p.A,{attrs:{cols:"12",sm:"6"}},[s(I.A,{attrs:{label:"split",outlined:"",dense:"","hide-details":"",type:"number"},model:{value:t.split,callback:function(s){e.$set(t,"split",s)},expression:"end.split"}})],1)],1)],1)],1)})),0===e.note.end.size?s(n.A,{staticClass:"mx-4 mb-0",attrs:{dense:"",type:"warning",rounded:"lg"}},[e._v(" 終点が1つもありません ")]):e._e()],2),s(c.SL,{staticClass:"pt-0"},[s(r.A,{attrs:{color:"error",text:""},on:{click:e.deleteThisNote}},[s(A.A,{attrs:{left:""}},[e._v("mdi-delete")]),e._v(" ノートを削除 ")],1)],1)],1):e._e()],1)},xe=[],ke=i.A.extend({inject:["deleteNotes"],data(){return{menu:!1}},props:{note:{type:Object,required:!0},measureData:{type:Array,required:!0}},methods:{getLeft(e){return 60*(e.lane-1)+60},getBottom(e){return this.measureData[e.measure].measurePositionBottom+e.position/e.split*this.measureData[e.measure].measureHeight},getWidth(e){return 60},deleteThisNote(){this.deleteNotes(this.note.index),this.menu=!1}},computed:{drawType(){return 90===this.note.type?Number(this.note.option[0]):this.note.type},drawOptions(){return 90===this.note.type?this.note.option.slice(1):this.note.option}}}),Ne=ke,Se=(0,ce.A)(Ne,we,xe,!1,null,"62405719",null),Ce=Se.exports,Oe=function(){var e,t=this,s=t.$createElement,i=t._self._c||s;return i("div",[i("span",{staticClass:"note",class:(e={},e["type"+t.drawType]=!0,e.isDummy=90===t.note.type,e.shadow=!t.isPreAppend,e.preappend=t.isPreAppend,e),style:{left:t.getAbsoluteLeft(t.note)+"px",bottom:t.getAbsoluteBottom(t.note)+"px",width:t.getWidth(t.note)+"px",background:t.dispColor},on:{click:t.calcelThisNote}},[94===t.note.type?i("img",{style:{height:t.measureData.last.measureHeight*Number(t.note.option[2])+"px"},attrs:{src:String(t.note.option[0]).startsWith("texture")?"https://db.otofuda.com/"+t.note.option[0]:t.note.option[0],alt:"texture"}}):t._e(),100===t.note.type?i(A.A,{staticClass:"mt-2",attrs:{color:"warning"}},[t._v(" mdi-comment ")]):t._e(),100===t.note.type?i(te.A,{staticClass:"elevation-4",attrs:{outlined:"","background-color":"amber lighten-4","hide-details":"",disabled:""},model:{value:t.note.option[0],callback:function(e){t.$set(t.note.option,0,e)},expression:"note.option[0]"}}):t._e(),t._v(" "+t._s(t.note.position)+"/"+t._s(t.note.split)+" "),t.isPreAppend?i("span",{staticClass:"preappend__index"},[t._v("#"+t._s(t.note.index))]):t._e()],1),t._l(t.note.end,(function(e,s){var n;return i("div",{key:s},[i("span",{staticClass:"note",class:(n={},n["type"+e.type]=!0,n.shadow=!t.isPreAppend,n.preappend=t.isPreAppend,n),style:{left:t.getAbsoluteLeft(e)+"px",bottom:t.getAbsoluteBottom(e)+"px",width:t.getWidth(e)+"px"}},[t._v(" "+t._s(e.position)+"/"+t._s(e.split)+" ")]),i("i",{staticClass:"note-hold",class:{shadow:!t.isPreAppend,preappend:t.isPreAppend},style:{bottom:t.getAbsoluteBottom(t.note)+"px",left:t.getAbsoluteLeft(e)+"px",height:t.getAbsoluteBottom(e)-t.getAbsoluteBottom(t.note)+"px"}})])}))],2)},Te=[],De=i.A.extend({inject:["cancelNote"],props:{note:{type:Object,required:!0},measureData:{type:Array,required:!0},isPreAppend:{type:Boolean,default:!1}},methods:{getLeft(e){const t=90===e.type?Number(e.option[0]):e.type,s=90===e.type?e.option.slice(1):e.option;if([1,2,95,100].includes(t))return 60*(e.lane-1);if([3,4].includes(t)){let t=Number(s[0])||3;-1===t&&(t=3);let i=60*(e.lane-1)+30,n=0;return s[1]&&s[2]&&(n=Number(s[1])/Number(s[2])*60),i-t/2*60+n}if(94===t){let t=Number(s[1])||1,i=60*(e.lane-1)+30,n=0;return s[3]&&s[4]&&(n=Number(s[3])/Number(s[4])*60),i-t/2*60+n}return 96===t?-50:0},getAbsoluteLeft(e){return this.getLeft(e)+60},getBottom(e){const t=this.measureData[e.measure]||this.measureData.last;return e.position/e.split*t.measureHeight},getAbsoluteBottom(e){const t=this.measureData[e.measure];if(t)return t.measurePositionBottom+e.position/e.split*t.measureHeight;{const t=this.measureData.last,s=e.measure-t.measure;return s*t.measureHeight+t.measurePositionBottom+e.position/e.split*t.measureHeight}},getWidth(e){const t=90===e.type?Number(e.option[0]):e.type,s=90===e.type?e.option.slice(1):e.option;if([1,2,100].includes(t))return 60;if([3,4].includes(t)){let e=Number(s[0])||3;return-1===e&&(e=3),60*e}if(94===t){let e=Number(s[1])||1;return 60*e}if(95===t){let t=Number(s[0])||1;return-1===t&&(t=1),0===e.position&&(t=5),60*t}return 96===t?40:300},calcelThisNote(){this.isPreAppend&&this.cancelNote(this.note.index)}},computed:{dispColor(){return 96===this.note.type?-1===Number(this.note.option[0])&&-1===Number(this.note.option[1])&&-1===Number(this.note.option[2])?"linear-gradient(0deg, #ff5151 20%, #44a5ff 80%)":`rgb(${this.note.option[0]},${this.note.option[1]},${this.note.option[2]})`:null},drawType(){return 90===this.note.type?Number(this.note.option[0]):this.note.type}}}),Pe=De,Me=(0,ce.A)(Pe,Oe,Te,!1,null,"51a50148",null),Le=Me.exports,$e=i.A.extend({name:"ThePreview",inject:["showSnackbar"],props:{currentChart:{type:Array,default:()=>[]},currentDifficulty:{type:String,default:"easy"},measureData:{type:Array,default:()=>[]},previewAudio:{type:HTMLAudioElement},audioVolume:{type:Number,default:100},infoObject:{type:Object,required:!0},appendNote:{type:Object,required:!1,default:null},preAppendNotes:{type:Array,required:!1,default:null},isShowDetail:{type:Boolean,default:!1},isCaptureMode:{type:Boolean,default:!1},isPreviewMode:{type:Boolean,default:!1},isImageMode:{type:Boolean,default:!1}},data(){return{isPreviewing:!1,returnPosition:-1,currentPosition:0,timeoutIds:new Array,intervalId:null,startFrom:0,currentMeasure:0,currentBpm:0,currentBeat:0,currentCombo:0,isShowCheckbox:!1,isShowKeybeam:!1,isShowHandguide:!1,isShowFlickEffect:!1,isSimulateLED:!1,isPlayGuide:!1,eventIds:new Array,isPlayKeySound:!1,isPlayKeySoundEnd:!1,guideAudio:new Audio("/chart-editor/guide.mp3"),defaultLEDColor:"linear-gradient(0deg, #ff5151 30%, #44a5ff 70%)",lift:Number(localStorage.getItem("chart-editor__lift"))||0,sudden:Number(localStorage.getItem("chart-editor__sudden"))||0,hidden:Number(localStorage.getItem("chart-editor__hidden"))||0,comboOffset:60,drawOffset:0,keybeamLength:100,comboOpacity:50,isObjectBasedPreview:!1}},watch:{lift(e){localStorage.setItem("chart-editor__lift",String(e))},sudden(e){localStorage.setItem("chart-editor__sudden",String(e))},hidden(e){localStorage.setItem("chart-editor__hidden",String(e))}},methods:{screenshot(){Z()(document.querySelector(".preview"),{allowTaint:!0}).then((e=>{document.querySelector(".panel").appendChild(e)}))},getMeasureNotes(e){return this.currentChart.filter((t=>t.measure===e))},playFromMeasure(){const e=this.startOffset,t=60/this.infoObject.bpm*this.infoObject.beat*1e3;setTimeout((()=>{this.previewAudio.volume=this.audioVolume/100,this.previewAudio.currentTime=e/1e3,this.previewAudio.play()}),t),this.measureData.forEach(((t,s)=>{const i=this.measureData[s+1]||{};if(t.measureReachTime>e){const s=0===t.measureLength?-30:0;this.timeoutIds.push(setTimeout((()=>{this.currentPosition=i.measurePositionBottom;const e=i.measureReachTime-t.measureReachTime,s=this.$refs.preview;if(console.log("warp confirm",t.measureLength),0===t.measureLength)return console.log("warp",this.currentPosition),s.style.transition="none",void(s.style.bottom=`-${this.currentPosition}px`);s.style.transition=`${e}ms all linear`,s.style.bottom=`-${this.currentPosition}px`,this.isPlayGuide&&(this.guideAudio.currentTime=0,this.guideAudio.play())}),t.measureReachTime-e+s))}})),this.setNoteEvents(e)},playFromZero(){setTimeout((()=>{this.previewAudio.currentTime=0,this.previewAudio.volume=this.audioVolume/100,this.previewAudio.play()}),60/this.infoObject.bpm*this.infoObject.beat*1e3);const e=[...this.measureData];e.forEach(((t,s)=>{const i=e[s+1]||{},n=0===t.measureLength?-30:0;this.timeoutIds.append(setTimeout((()=>{this.currentPosition=i.measurePositionBottom;const e=i.measureReachTime-t.measureReachTime,s=this.$refs.preview;s.style.transition=`${e}ms all linear`,s.style.bottom=`-${this.currentPosition}px`,this.isPlayGuide&&(this.guideAudio.currentTime=.1,this.guideAudio.play())}),t.measureReachTime+n))})),this.setNoteEvents(0)},setNoteEvents(e){let t=-500,s=null;const i=this.isShowFlickEffect,n=this.isShowHandguide;Object.entries(this.previewEvents).forEach((([o,a])=>{const r=Number(o)-e,l=this.$refs.keybeams.querySelectorAll("div"),c=this.$refs.currentCombo,d=this.$refs.handguide;r>0?this.eventIds.push(setTimeout((()=>{if(a.sound&&this.isPlayKeySound){const e=new Audio("/chart-editor/guide.mp3");e.currentTime=.1,e.play()}if(this.isShowKeybeam){if(a.lane.each((e=>{l[e].classList.add("-on")})),setTimeout((()=>{a.lane.each((e=>{l[e].classList.remove("-on")}))}),25),a.hold.each((([e,t])=>{l[e].classList.add("-hold"),this.eventIds.push(setTimeout((()=>{if(l[e].classList.remove("-hold"),this.currentCombo+=1,c.textContent=String(this.currentCombo),a.sound&&this.isPlayKeySound&&this.isPlayKeySoundEnd){const e=new Audio("/chart-editor/guide.mp3");e.currentTime=.1,e.play()}}),t))})),a.handMove&&i&&a.noteObject){const e=document.createElement("div");e.classList.add("flick-effect",a.handMove),this.$refs.keybeams.appendChild(e);const t=60*(a.noteObject.lane-1)+30;let s=0,i=Number(a.noteObject.option[0])||3;a.noteObject.option[1]&&a.noteObject.option[2]&&(s=Number(a.noteObject.option[1])/Number(a.noteObject.option[2])*60),-1===i&&(i=3),e.style.left=`${t-i/2*60+s}px`,e.style.width=60*i+"px",setTimeout((()=>{this.$refs.keybeams.removeChild(e)}),250)}this.currentCombo+=a.count,c.textContent=String(this.currentCombo)}n&&a.handMove&&(d.classList.add(a.handMove),s&&Number(o)-t>200&&clearTimeout(s),s=setTimeout((()=>{d.classList.remove(a.handMove)}),200),t=Number(o)),this.isSimulateLED&&a.color&&this.setLEDColor(a.color)}),r)):(this.currentCombo+=a.count+a.hold.size,this.isSimulateLED&&a.color&&this.setLEDColor(a.color))}))},previewStart(){if(!this.measureData[this.startFrom])return this.showSnackbar(`${this.startFrom}小節はありません`),!1;this.returnPosition=window.scrollY,this.isPreviewing=!0,this.currentCombo=0,this.$refs.currentCombo.textContent=String(this.currentCombo),this.$refs.preview.style.bottom=`-${this.measureData.first.measurePositionBottom}px`,this.$refs.preview.style.transition="none",0===this.startFrom?this.playFromZero():this.playFromMeasure()},previewStop(){this.previewAudio.pause(),this.isPreviewing=!1,this.currentPosition=0,this.currentBpm=0,this.currentBeat=0,this.currentCombo=0,this.setLEDColor(),this.$refs.keybeams?.querySelectorAll("div").forEach((e=>e.classList.remove("-hold"))),this.$refs.handguide.classList.remove("-left","-right"),this.$refs.preview.style.transition="0ms all linear",this.$refs.preview.style.bottom="0px",this.timeoutIds.each((e=>clearInterval(e))),this.timeoutIds=[],this.eventIds.each((e=>clearInterval(e))),this.eventIds=[],this.returnPosition>=0&&setTimeout((()=>{window.scrollTo({top:this.returnPosition,behavior:"auto"}),this.returnPosition=-1}),50)},setLEDColor(e){this.$refs.LEDLeft.style.background=e||this.defaultLEDColor,this.$refs.LEDRight.style.background=e||this.defaultLEDColor,this.isPreviewMode&&(this.$refs.LEDLeftShadow.style.background=e||this.defaultLEDColor,this.$refs.LEDRightShadow.style.background=e||this.defaultLEDColor)}},computed:{longNotes(){return this.currentChart.filter((e=>2===e.type||90===e.type&&"2"===e.option[0]))},previewEvents(){const e={};return(this.isPlayKeySound||this.isShowKeybeam||this.isSimulateLED)&&this.currentChart.each((t=>{const s=this.measureData[t.measure],i=s.measureReachTime+t.position/t.split*s.measureLength;!e[i]&&[1,2,3,4,5,96].includes(t.type)&&(e[i]={timing:i,lane:[],hold:[],holdEnd:[],color:null,count:0,sound:!1,handMove:null,noteObject:null}),1===t.type?(e[i].sound=!0,e[i].count+=1,e[i].lane=e[i].lane.append(t.lane).uniq):2===t.type?(e[i].sound=!0,t.end.each((s=>{const n=this.measureData[s.measure],o=n.measureReachTime+s.position/s.split*n.measureLength;e[i].hold=e[i].hold.append([t.lane,o-i])}))):3===t.type||4===t.type?(e[i].sound=!0,e[i].count+=1,e[i].noteObject=t,3===t.type?e[i].handMove="-left":e[i].handMove="-right"):5===t.type?(e[i].sound=!0,e[i].count+=1,e[i].lane=e[i].lane.append(0).uniq):96===t.type&&(-1===Number(t.option[0])&&-1===Number(t.option[1])&&-1===Number(t.option[2])?e[i].color=this.defaultLEDColor:e[i].color=`rgb(${t.option[0]},${t.option[1]},${t.option[2]})`)})),e},entireHeight(){return this.measureData.last?.measurePositionBottom+this.measureData.last?.measureHeight},startOffset(){return this.measureData[this.startFrom].measureReachTime},previewDelay(){return 10*this.measureData.size+100}},components:{MeasureComponent:fe,ObjectBasedMeasure:_e,LongNote:Ce,NoteShadow:Le}}),je=$e,Ee=(0,ce.A)(je,W,G,!1,null,"51809648",null),Be=Ee.exports,Fe=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"mt-2"},[s(C.A,{attrs:{align:"center",justify:"space-between"}},[s("p",{staticClass:"mb-0"},[e._v("終点 #"+e._s(e.index))]),s("div",[s(r.A,{attrs:{color:"primary",text:"",dense:""},on:{click:e.addEndToThis}},[s(A.A,{attrs:{left:""}},[e._v("mdi-plus-circle-outline")]),e._v(" ここに終点を追加 ")],1),s(r.A,{attrs:{color:"error",text:"",dense:""},on:{click:e.deleteThisEnd}},[s(A.A,{attrs:{left:""}},[e._v("mdi-delete")]),e._v(" この終点を削除 ")],1)],1)]),s(C.A,{staticClass:"mb-2"},[s(p.A,{attrs:{cols:"12",sm:"3"}},[s(O.A,{attrs:{items:[1,2,3,4,5],"hide-details":"",label:"lane",outlined:"",dense:"","menu-props":{rounded:"lg"}},model:{value:e.end.lane,callback:function(t){e.$set(e.end,"lane",t)},expression:"end.lane"}})],1),s(p.A,{attrs:{cols:"12",sm:"3"}},[s(I.A,{attrs:{label:"measure",outlined:"",dense:"","hide-details":"",type:"number",min:"0"},model:{value:e.end.measure,callback:function(t){e.$set(e.end,"measure",e._n(t))},expression:"end.measure"}})],1),s(p.A,{attrs:{cols:"12",sm:"3"}},[s(I.A,{attrs:{label:"position",outlined:"",dense:"","hide-details":"",min:"0",max:e.end.split-1,"background-color":"#f0f0b0"},on:{keydown:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.placeNotes(t)},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"left",37,t.key,["Left","ArrowLeft"])||"button"in t&&0!==t.button?null:e.endToLeft(t)},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"right",39,t.key,["Right","ArrowRight"])||"button"in t&&2!==t.button?null:e.endToRight(t)},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"up",38,t.key,["Up","ArrowUp"])?null:e.endToUp(t)},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"down",40,t.key,["Down","ArrowDown"])?null:e.endToDown(t)}]},model:{value:e.end.position,callback:function(t){e.$set(e.end,"position",e._n(t))},expression:"end.position"}})],1),s(p.A,{attrs:{cols:"12",sm:"3"}},[s(m.A,{attrs:{items:[4,8,16,32,12,24,48],label:"split",outlined:"","hide-details":"",dense:"","menu-props":{rounded:"lg"}},model:{value:e.end.split,callback:function(t){e.$set(e.end,"split",e._n(t))},expression:"end.split"}})],1)],1),e._l(e.errors,(function(t){return s(n.A,{key:"append_end_"+e.index+"_error"+t,attrs:{dense:"",type:"error",rounded:"lg"}},[e._v(" "+e._s(t)+" ")])})),s("div",{staticClass:"recursive-end"},e._l(e.end.end,(function(t,i){return s("EndForm",{key:"append_end_"+e.index+"_"+i,attrs:{end:t,parent:e.end,index:i},on:{"delete-end":e.deleteChild}})})),1)],2)},Ie=[],He=i.A.extend({name:"EndForm",props:{end:{type:Object,required:!0},parent:{type:Object,required:!0},index:{type:Number,required:!0},maxMeasure:{type:Number,required:!0}},methods:{addEndToThis(){this.end.end.append({type:1,lane:this.end.lane,measure:this.end.measure,position:Math.min(this.end.position+1,this.end.split),split:this.end.split,option:[],end:[]})},deleteThisEnd(){this.$emit("delete-end",this.index)},deleteChild(e){this.end.end.delete_at(e)},endToLeft(){this.end.lane=Math.max(this.end.lane-1,1),this.$emit("append-to-left",this.index)},endToRight(){this.end.lane=Math.min(this.end.lane+1,5),this.$emit("append-to-right",this.index)},endToUp(e){const t=this.end;t.split-1<=t.position?(t.measure++,t.position=0):t.position++,e.shiftKey&&this.$emit("append-to-up",this.index)},endToDown(e){const t=this.end;0===t.position?(t.measure--,t.position=t.split-1):t.position--,e.shiftKey&&this.$emit("append-to-down",this.index)},placeNotes(){this.$emit("place-notes")}},computed:{parentPosition(){return this.parent.measure+this.parent.position/this.parent.split},selfPosition(){return this.end.measure+this.end.position/this.end.split},errors(){const e=new Array;return this.selfPosition<=this.parentPosition&&e.append("終点が親ノートよりも手前または同じ位置にあります。"),this.end.lane!==this.parent.lane&&e.append("終点と親ノートのレーン位置が異なります。"),this.end.measure>this.maxMeasure&&e.append(`存在しない小節に終点を配置できません(現在、譜面は${this.maxMeasure}小節まで)`),e}}}),ze=He,Re=(0,ce.A)(ze,Fe,Ie,!1,null,"47f42483",null),Ke=Re.exports,qe=i.A.extend({name:"App",mixins:[oe,ae],data(){return{isLoaded:!1,reader:new FileReader,previewAudio:new Audio,audioVolume:100,fileName:"default-song.json",difficulties:["raku","easy","normal","hard","extra"],currentDifficulty:"easy",chartObject:{raku:[],easy:[],normal:[],hard:[],extra:[],info:{version:2,offset:0,bpm:120,beat:4}},dialog:{selectionDelete:!1,analyzer:!1,help:!1,logs:!1,checked:!1,batchcheck:!1,texture:!1},texturePayload:{contents:[]},textureTabs:[],textureCurrentTab:null,analysisData:{notesCount:0,trendValues:[],trendLabels:[],otofudaNotes:[],typeCount:{}},appendNote:{type:1,lane:1,measure:1,position:0,split:8,option:[],end:[]},preAppendNotes:[],colorSwatches:[["#ff5151","#000000"],["#44a5ff","#202020"],["#ff0000","#505050"],["#00ff00","#a0a0a0"],["#0000ff","#ffffff"]],isAppendMode:!0,isAutoFollow:!0,scrollTo:0,isShowDetail:!1,isCaptureMode:!1,isPreviewMode:!1,isImageMode:!1,isSimulateStop:!1,batchSelectTypes:[],batchSelectStart:0,batchSelectEnd:0,selectionLaneTo:1,selectionLaneAddition:1,selectionTypeTo:1,selectionMeasureAddition:0,snackbar:!1,snackbarText:"メッセージ",logs:[],beatHeight:Number(localStorage.getItem("chart-editor__beat-height"))||100}},provide(){return{showSnackbar:this.showSnackbar,deleteNotes:this.deleteNotes,cancelNote:this.cancelNote,appendNotes:this.appendNotes,getMovedNote:this.getMovedNote,copyNotesToDifficulty:this.copyNotesToDifficulty,setAppendNoteInfo:this.setAppendNoteInfo}},beforeCreate(){new R.j},created:function(){document.addEventListener("keydown",this.onPressKey)},mounted(){this.reader.onload=e=>{e.target&&e.target.result&&(this.chartObject=JSON.parse(String(e.target.result)),this.difficulties.each((e=>{this.chartObject[e]=this.chartObject[e].map(((e,t)=>({...e,index:t,isSelected:!1})))})),this.isLoaded=!0)},window.addEventListener("beforeunload",(e=>{e.preventDefault(),e.returnValue="移動してもよろしいですか？"})),fetch("https://otofuda.microcms.io/api/v1/textures?limit=1000",{headers:{"X-API-KEY":"91c69bf8-3df5-445f-81e7-30b54ab4a7d4"}}).then((e=>e.json())).then((e=>{this.texturePayload=e;const t=[];this.texturePayload.contents.each((e=>t.append(...e.tab))),this.textureTabs=t.uniq,this.textureCurrentTab=t.first})),console.log("App",this)},methods:{readFile(e){this.fileName=e.name,this.reader.readAsText(e)},newFile(){this.fileName="default.json",this.isLoaded=!0},saveFile(){const e={raku:[],easy:[],normal:[],hard:[],extra:[],info:{version:2,...this.chartObject.info}};this.difficulties.each((t=>{e[t]=this.chartObject[t].map(this.getValidatedNote)})),console.log("saveObject",e);const t=new Blob([JSON.stringify(e,null,4)],{type:"application/json"}),s=document.createElement("a");s.href=URL.createObjectURL(t),s.download=this.fileName,document.body.appendChild(s),s.click(),document.body.removeChild(s),this.showSnackbar(`ファイル「${this.fileName}」を保存しました`)},readAudioFile(e){this.previewAudio.src=window.URL.createObjectURL(e)},zoomOut(){this.beatHeight=this.beatHeight-10||0},zoomIn(){this.beatHeight=this.beatHeight+10||100},scrollToMeasure(e){if(!this.measureData[e])return void this.showSnackbar(`${e}小節はありません`);const t=this.measureData.last?.measurePositionBottom-this.measureData[e].measurePositionBottom;this.$vuetify.goTo(t)},appendNotes(...e){e.each((e=>{const t=this.isDuplicated(e,{checkPreAppend:!1});if(t)return this.showSnackbar(`${t}個のノーツと重複しているため、挿入できないノーツがありました`),!1;const s=0===this.currentChart.size?1:this.currentChart.max_by((e=>e.index)).index+1;this.currentChart?.append({isSelected:!1,...JSON.parse(JSON.stringify(e)),index:s,option:this.getValidatedOptions(e)})})),this.showSnackbar(`${e.size}個のノートの挿入を試行しました`),this.preAppendNotes=[]},placeNotes(...e){e.each((e=>{const t=this.isDuplicated(e);if(t)return this.showSnackbar(`${t}個のノーツと重複しているため、配置はキャンセルされました`),!1;const s=0===this.preAppendNotes.size?1:this.preAppendNotes.max_by((e=>e.index||-1)).index+1;this.preAppendNotes.append({isSelected:!1,...JSON.parse(JSON.stringify(e)),option:this.getValidatedOptions(e),index:s})}))},appendSimultaneously(...e){e.each((e=>{let t=0;this.difficulties.each((s=>{const i=this.isDuplicated(e,{comparators:this.chartObject[s]});if(i)return this.showSnackbar(`${i}個のノーツと重複しているため、${s}に挿入できません`),!1;this.chartObject[s]?.append({isSelected:!1,...JSON.parse(JSON.stringify(e)),index:this.chartObject[s].size}),t++})),this.showSnackbar(`ノートを${t}難易度に同時挿入しました`)}))},addEndToAppendNote(){this.appendNote.end.append({type:1,lane:this.appendNote.lane,measure:this.appendNote.measure,position:Math.min(this.appendNote.position+1,this.appendNote.split),split:this.appendNote.split,option:[],end:[]})},deleteEndOfAppendNote(e){this.appendNote.end.delete_at(e)},changeAppendNoteType(){switch(2===this.appendNote.type?this.addEndToAppendNote():this.appendNote.end=[],this.appendNote.type){case 3:case 4:this.appendNote.option=["-1"];break;case 90:this.appendNote.option=["1"];break;case 93:this.appendNote.option=["4"];break;case 94:this.appendNote.option=["texture/202020.png","1","0.25"];break;case 95:this.appendNote.option=["5"];break;case 96:this.appendNote.option=["255","81","81"];break;case 100:this.appendNote.option=["ここにコメントを入力"];break;default:this.appendNote.option=[]}this.isLanelessNote(this.appendNote)?this.appendNote.lane=-1:-1===this.appendNote.lane&&(this.appendNote.lane=1)},appendNoteToLeft(){this.appendNote.lane=Math.max(this.appendNote.lane-1,1)},appendNoteToRight(){this.appendNote.lane=Math.min(this.appendNote.lane+1,5)},appendNoteToUp(){const e=this.appendNote;e.split-1<=e.position?(e.measure++,e.position=0,this.isAutoFollow&&this.measureData[e.measure]&&this.scrollToMeasure(e.measure)):e.position++},appendNoteToDown(){const e=this.appendNote;0===e.position?(e.measure--,e.position=e.split-1,this.isAutoFollow&&this.scrollToMeasure(e.measure)):e.position--},deleteNotes(...e){e.each((e=>{this.chartObject[this.currentDifficulty]=this.currentChart?.delete_if((t=>t.index===e))}))},setAppendNoteInfo(e){this.appendNote={...this.appendNote,...e,index:null}},cancelNote(e){this.preAppendNotes=this.preAppendNotes?.delete_if((t=>t.index===e))},copyNotesToDifficulty(e,...t){const s=this.currentDifficulty;this.currentDifficulty=e||this.currentDifficulty,this.appendNotes(...t),this.currentDifficulty=s},getMovedNote(e,t){const s=t-e.measure;return{...e,measure:t,end:e.end.map((e=>this.getMovedNote({...e},t+s)))}},selectionClear(){this.chartObject[this.currentDifficulty]=this.currentChart?.map((e=>({...e,isSelected:!1})))},selectionDelete(){const e=this.selectionNumber;this.chartObject[this.currentDifficulty]=this.currentChart?.delete_if((e=>e.isSelected)),this.dialog.selectionDelete=!1,this.showSnackbar(`${e}個のノーツを削除しました`)},selectionChangeType(e){const t=Number(e);if([2,5,94].includes(t))return void this.showSnackbar(`Typeを${t}に一括変更することはできません`);const s=this.chartObject[this.currentDifficulty].filter((e=>e.isSelected&&![2,5].includes(e.type)));0!==s.size?(s.each((e=>e.type=t)),this.showSnackbar(`Type:${t}への一括変更を実行しました`),this.dialog.checked=!1):this.showSnackbar("対象ノーツがありません(Type一括変更)")},selectionChangeLane(e){const t=e,s=this.chartObject[this.currentDifficulty].filter((e=>e.isSelected&&![2,5].includes(e.type)));0!==s.size?(s.each((e=>e.lane=t)),this.showSnackbar(`Lane:${t}への一括変更を実行しました`),this.dialog.checked=!1):this.showSnackbar("対象ノーツがありません(Lane一括変更)")},selectionAddLane(e){const t=Number(e),s=this.chartObject[this.currentDifficulty].filter((e=>e.isSelected&&![2,5].includes(e.type)));0!==s.size?(t<0?(s.each((e=>e.lane=Math.max(e.lane+t,1))),this.showSnackbar(`${t} 一括減算処理を実行しました`)):(s.each((e=>e.lane=Math.min(e.lane+t,5))),this.showSnackbar(`+${t} 一括加算処理を実行しました`)),this.dialog.checked=!1):this.showSnackbar("対象ノーツがありません(Lane一括加算)")},selectionAddMeasure(e){const t=Number(e),s=this.chartObject[this.currentDifficulty].filter((e=>e.isSelected));s.each((e=>{e.measure=Math.max(e.measure+t,0),e.end.each((e=>{e.measure=Math.max(e.measure+t,0)}))})),this.showSnackbar(`小節位置 ${t} 一括処理を実行しました`),this.dialog.checked=!1},batchSelect(){const e=this.batchSelectTarget.size;this.batchSelectTarget.each((e=>e.isSelected=!0)),this.dialog.batchcheck=!1,this.showSnackbar(`${e}個のノーツを一括選択しました`)},showSnackbar(e){this.snackbar=!1,this.snackbarText=e,setTimeout((()=>this.snackbar=!0),100),this.logs.append({message:e,type:"通知バー",date:new Date})},analyze(){this.analysisData.trendLabels=[],this.analysisData.trendValues=[],this.analysisData.otofudaNotes=[],this.analysisData.notesCount=0,this.noteTypes.each((e=>{this.analysisData.typeCount[e.value]=0})),this.measureData.each((e=>{e.measure%10===0?this.analysisData.trendLabels.append(String(e.measure)):this.analysisData.trendLabels.append(" "),this.analysisData.trendValues.append(0),this.analysisData.otofudaNotes.append(0)})),this.currentChart.each((e=>{[1,2,3,4,5].includes(e.type)&&(this.analysisData.trendValues[e.measure]+=1,this.analysisData.notesCount+=1),5===e.type&&(this.analysisData.otofudaNotes[e.measure]+=1),this.analysisData.typeCount[e.type]+=1})),this.dialog.analyzer=!0},setTexture(e){const t=this.appendNote;94===t.type?(this.$set(t.option,0,e.url),this.$set(t.option,1,e.width||t.option[1]),this.showSnackbar(`テクスチャ「${e.name}をセットしました`)):this.showSnackbar("挿入中のノートがテクスチャではありません")},restoreBackup(){const e=window.confirm("バックアップからデータを復元しますか？(現在の譜面データは失われます)"),t=localStorage.getItem("chart-editor__backup");e&&t&&(this.chartObject=JSON.parse(t),this.showSnackbar("バックアップから復元しました"))},onPressKey(e){e.ctrlKey&&"s"===e.key&&(e.preventDefault(),console.log(JSON.stringify(this.chartObject)),localStorage.setItem("chart-editor__backup",JSON.stringify(this.chartObject)),this.showSnackbar("譜面バックアップを保存しました"))}},watch:{beatHeight(e){localStorage.setItem("chart-editor__beat-height",e)}},computed:{currentChart(){return this.chartObject[this.currentDifficulty]||[]},musicBpm(){return this.chartObject.info.bpm},musicBeat(){return this.chartObject.info.beat},musicOffset(){return this.chartObject.info.offset},maxMeasure(){return this.currentChart.size>0?this.currentChart.max_by((e=>e.measure)).measure:1},measureData(){const e=[];let t=this.musicBeat,s=this.musicBpm,i=this.musicOffset,n=this.musicOffset/(60/s*1e3)*this.beatHeight;return(this.maxMeasure+1).times((o=>{const a=this.currentChart.find((e=>97===e.type&&e.measure===o)),r=this.currentChart.find((e=>98===e.type&&e.measure===o)),l=this.currentChart.find((e=>92===e.type&&e.measure===o)),c=this.currentChart.find((e=>93===e.type&&e.measure===o));a&&(t=Number(a.option[0])),r&&(s=Number(r.option[0]));let d=this.beatHeight*t;l&&this.isSimulateStop&&(d=0),c&&(d=this.beatHeight*Number(c.option[0]));let u=60/s*t*1e3;c&&(u=0),e.push({measure:o,measureBpm:s,measureBeat:t,measureReachTime:i,measurePositionBottom:n,measureHeight:d,measureLength:u}),i+=u,n+=d})),e},batchSelectTarget(){const e=this.batchSelectStart,t=0===this.batchSelectEnd?1/0:this.batchSelectEnd;return this.currentChart.filter((s=>this.batchSelectTypes.includes(s.type)&&s.measure>=e&&s.measure<=t))},selectionNumber(){return this.currentChart.filter((e=>e.isSelected)).size},getAppendNote(){return this.isAppendMode?this.appendNote:null},appendNoteColorOption:{get:function(){return 96===this.appendNote.type?{r:String(this.appendNote.option[0]),g:String(this.appendNote.option[1]),b:String(this.appendNote.option[2]),a:1}:null},set:function(e){96===this.appendNote.type&&e&&(this.$set(this.appendNote.option,0,e.r),this.$set(this.appendNote.option,1,e.g),this.$set(this.appendNote.option,2,e.b))}},noteOptionsForAppendNote(){return this.noteOptions(this.appendNote)}},components:{Preview:Be,EndForm:Ke}}),Ve=qe,Qe=(0,ce.A)(Ve,H,z,!1,null,null,null),Ue=Qe.exports,Je=s(2359);i.A.use(Je.A);var We=new Je.A({lang:{current:"ja"}});i.A.config.productionTip=!1,new i.A({vuetify:We,render:e=>e(Ue)}).$mount("#app")}},t={};function s(i){var n=t[i];if(void 0!==n)return n.exports;var o=t[i]={exports:{}};return e[i].call(o.exports,o,o.exports,s),o.exports}s.m=e,function(){var e=[];s.O=function(t,i,n,o){if(!i){var a=1/0;for(d=0;d<e.length;d++){i=e[d][0],n=e[d][1],o=e[d][2];for(var r=!0,l=0;l<i.length;l++)(!1&o||a>=o)&&Object.keys(s.O).every((function(e){return s.O[e](i[l])}))?i.splice(l--,1):(r=!1,o<a&&(a=o));if(r){e.splice(d--,1);var c=n();void 0!==c&&(t=c)}}return t}o=o||0;for(var d=e.length;d>0&&e[d-1][2]>o;d--)e[d]=e[d-1];e[d]=[i,n,o]}}(),function(){s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,{a:t}),t}}(),function(){s.d=function(e,t){for(var i in t)s.o(t,i)&&!s.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})}}(),function(){s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};s.O.j=function(t){return 0===e[t]};var t=function(t,i){var n,o,a=i[0],r=i[1],l=i[2],c=0;if(a.some((function(t){return 0!==e[t]}))){for(n in r)s.o(r,n)&&(s.m[n]=r[n]);if(l)var d=l(s)}for(t&&t(i);c<a.length;c++)o=a[c],s.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return s.O(d)},i=self["webpackChunkchart_editor"]=self["webpackChunkchart_editor"]||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))}();var i=s.O(void 0,[504],(function(){return s(5683)}));i=s.O(i)})();
//# sourceMappingURL=app.ca40c510.js.map