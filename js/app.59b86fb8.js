(function(e){function t(t){for(var r,a,s=t[0],u=t[1],c=t[2],p=0,f=[];p<s.length;p++)a=s[p],Object.prototype.hasOwnProperty.call(i,a)&&i[a]&&f.push(i[a][0]),i[a]=0;for(r in u)Object.prototype.hasOwnProperty.call(u,r)&&(e[r]=u[r]);l&&l(t);while(f.length)f.shift()();return o.push.apply(o,c||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],r=!0,s=1;s<n.length;s++){var u=n[s];0!==i[u]&&(r=!1)}r&&(o.splice(t--,1),e=a(a.s=n[0]))}return e}var r={},i={app:0},o=[];function a(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=r,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)a.d(n,r,function(t){return e[t]}.bind(null,r));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/chart-editor/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],u=s.push.bind(s);s.push=t,s=s.slice();for(var c=0;c<s.length;c++)t(s[c]);var l=u;o.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"01ba":function(e,t,n){},"1d9a":function(e,t,n){},"484b":function(e,t,n){},"56d6":function(e,t,n){"use strict";var r=n("1d9a"),i=n.n(r);i.a},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("2b0e"),i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-app",{attrs:{id:"app"}},[n("Preview",{attrs:{currentChart:e.currentChart,infoObject:e.chartObject.info,measureData:e.measureData,previewAudio:e.previewAudio}}),n("v-container",{staticClass:"panel",attrs:{fluid:""}},[n("v-row",{attrs:{align:"center"}},[n("v-file-input",{attrs:{accept:".json, application/json",label:"ファイルを選択",outlined:"",dense:"","prepend-icon":"mdi-folder"},on:{change:e.readFile}}),n("v-col",[n("v-select",{attrs:{items:e.difficulties,label:"難易度",align:"left",outlined:"",dense:""},model:{value:e.currentDifficulty,callback:function(t){e.currentDifficulty=t},expression:"currentDifficulty"}})],1)],1),n("v-slider",{attrs:{min:"20",max:"250","append-icon":"mdi-magnify-plus-outline","prepend-icon":"mdi-magnify-minus-outline"},on:{"click:append":e.zoomIn,"click:prepend":e.zoomOut},model:{value:e.beatHeight,callback:function(t){e.beatHeight=t},expression:"beatHeight"}}),n("v-row",{attrs:{align:"center"}},[n("v-file-input",{attrs:{accept:"audio/*",label:"楽曲ファイル選択",outlined:"",dense:"","prepend-icon":"mdi-music"},on:{change:e.readAudioFile}})],1),n("v-row",{attrs:{align:"center"}},[n("v-text-field",{attrs:{label:"オフセット",required:""},model:{value:e.chartObject.info.offset,callback:function(t){e.$set(e.chartObject.info,"offset",e._n(t))},expression:"chartObject.info.offset"}})],1),n("v-row",[n("v-btn",{staticClass:"ml-1",attrs:{color:"success"},on:{click:e.saveFile}},[n("v-icon",{attrs:{left:""}},[e._v("mdi-content-save")]),e._v(" 保存 ")],1)],1)],1)],1)},o=[],a=(n("7db0"),n("b0c0"),n("d3b7"),n("3ca3"),n("ddb0"),n("2b3d"),n("0be7")),s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{ref:"preview",staticClass:"preview",style:{position:e.isPreviewing?"fixed":"relative",height:e.entireHeight+"px"}},[e._l(e.measureData,(function(t){return n("Measure",{key:"measure_"+t.measure,attrs:{measure:t,notes:e.currentChart.filter((function(e){return e.measure===t.measure}))}})})),e._l(e.currentChart.filter((function(e){return 2===e.type})),(function(t,r){return n("LongNote",{key:"longnote_"+r,attrs:{note:t,measureData:e.measureData}})}))],2),n("div",{staticClass:"control"},[n("v-expansion-panels",{attrs:{accordion:""}},[n("v-expansion-panel",[n("v-expansion-panel-header"),n("v-expansion-panel-content",[n("v-row",{staticClass:"control__info"},[e._v("BPM: "+e._s(e.currentBpm)+" BEAT: "+e._s(e.currentBeat))]),n("v-text-field",{attrs:{suffix:"小節から",outlined:"",dense:""},model:{value:e.startFrom,callback:function(t){e.startFrom=e._n(t)},expression:"startFrom"}}),n("v-btn",{staticClass:"mr-1",attrs:{outlined:"",color:"success"},on:{click:e.previewStart}},[n("v-icon",{attrs:{left:""}},[e._v("mdi-play")]),e._v(" 再生 ")],1),n("v-btn",{staticClass:"ml-1",attrs:{outlined:"",color:"error"},on:{click:e.previewStop}},[n("v-icon",{attrs:{left:""}},[e._v("mdi-stop")]),e._v(" 停止 ")],1)],1)],1)],1)],1)])},u=[],c=(n("4160"),n("159b"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"measure",class:{hiddenControl:e.notes.find((function(e){return 95===e.type&&0===e.position}))},style:{bottom:e.measure.measurePositionBottom+"px",height:e.measure.measureHeight+"px"}},[n("span",{staticClass:"measure__number",domProps:{textContent:e._s(e.measure.measure)}}),e._l(e.notes.filter((function(e){return 2!==e.type})),(function(t,r){return n("Note",{key:"note_"+e.measure.measure+"_"+r,attrs:{note:t,measure:e.measure}})}))],2)}),l=[],p=function(){var e,t=this,n=t.$createElement,r=t._self._c||n;return r("span",{class:(e={},e["type"+t.note.type]=!0,e.hidden=t.isHiddenControl,e),style:{left:t.positionLeft+"px",bottom:t.positionBottom+"px",width:t.noteWidth+"px"}},[t._v(" "+t._s(t.note.position)+"/"+t._s(t.note.split)+" "),97===t.note.type?r("strong",[t._v("BEAT "+t._s(t.note.option[0]))]):t._e(),98===t.note.type?r("strong",[t._v("BPM "+t._s(t.note.option[0]))]):t._e()])},f=[],d=(n("caad"),n("ac1f"),n("1276"),{data:function(){return{}},props:{note:{type:Object,required:!0},measure:{type:Object,required:!0}},computed:{positionLeft:function(){if([1,2,95].includes(this.note.type))return 60*(this.note.lane-1);if([3,4].includes(this.note.type)){var e=this.note.option[0]||3;-1===e&&(e=3);var t=60*(this.note.lane-1)+30,n=0;return this.note.option[1]&&this.note.option[2]&&(n=this.note.option[1]/this.note.option[2]*60),t-e/2*60+n}return 0},positionBottom:function(){return this.note.position/this.note.split*this.measure.measureHeight},noteWidth:function(){if([1,2].includes(this.note.type))return 60;if([3,4].includes(this.note.type)){var e=this.note.option[0]||3;return-1===e&&(e=3),60*e}if(95===this.note.type){var t=this.note.option[0]||1;return-1===t&&(t=1),0===this.note.position&&(t=5),60*t}return 300},isHiddenControl:function(){return 95===this.note.type&&0===this.note.position}}}),m=d,h=(n("56d6"),n("2877")),v=Object(h["a"])(m,p,f,!1,null,"031de0b2",null),b=v.exports,y={props:{notes:{type:Array,default:function(){return[]}},measure:{type:Object,required:!0},measureData:{type:Array,default:function(){return[]}}},components:{Note:b}},g=y,_=(n("935a"),Object(h["a"])(g,c,l,!1,null,"683e41e2",null)),w=_.exports,x=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("span",{class:"type"+e.note.type,style:{left:e.getLeft(e.note)+"px",bottom:e.getBottom(e.note)+"px",width:e.getWidth(e.note)+"px"}},[e._v(e._s(e.note.position)+"/"+e._s(e.note.split))]),e._l(e.note.end,(function(t,r){return n("div",{key:r},[n("span",{class:"type"+t.type,style:{left:e.getLeft(t)+"px",bottom:e.getBottom(t)+"px",width:e.getWidth(t)+"px"}},[e._v(e._s(e.note.position)+"/"+e._s(e.note.split))]),n("i",{style:{bottom:e.getBottom(e.note)+"px",left:e.getLeft(t)+"px",height:e.getBottom(t)-e.getBottom(e.note)+"px"}})])}))],2)},O=[],j={props:{note:{type:Object,required:!0},measureData:{type:Array,required:!0}},methods:{getLeft:function(e){return 60*(e.lane-1)+40},getBottom:function(e){return this.measureData[e.measure].measurePositionBottom+e.position/e.split*this.measureData[e.measure].measureHeight},getWidth:function(){return 60}}},B=j,P=(n("6ffe"),Object(h["a"])(B,x,O,!1,null,"75e53c18",null)),C=P.exports,D={data:function(){return{isPreviewing:!1,currentPosition:0,timeoutIds:[],startFrom:0,currentBpm:0,currentBeat:0}},props:{currentChart:{type:Array,default:function(){return[]}},measureData:{type:Array,default:function(){return[]}},previewAudio:{type:HTMLAudioElement},infoObject:{type:Object,required:!0}},methods:{playFromMeasure:function(){var e=this,t=this.startOffset;setTimeout((function(){e.previewAudio.currentTime=t/1e3,e.previewAudio.play()}),60/this.infoObject.bpm*this.infoObject.beat*1e3),this.measureData.forEach((function(n,r){var i=e.measureData[r+1]||{};n.measureReachTime>t&&e.timeoutIds.append(setTimeout((function(){e.currentPosition=i.measurePositionBottom,e.currentBpm=n.measureBpm,e.currentBeat=n.measureBeat;var t=i.measureReachTime-n.measureReachTime;e.$refs.preview.style.transition="".concat(t,"ms all linear"),e.$refs.preview.style.bottom="-".concat(e.currentPosition,"px")}),n.measureReachTime-t))}))},previewStart:function(){this.isPreviewing=!0,this.$refs.preview.style.transition="0ms all linear",this.$refs.preview.style.bottom="0px",this.$refs.preview.style.transition="".concat(this.measureData.first.measureReachTime,"ms all linear"),this.$refs.preview.style.bottom="-".concat(this.measureData.first.measurePositionBottom,"px"),this.playFromMeasure()},previewStop:function(){this.previewAudio.pause(),this.isPreviewing=!1,this.currentPosition=0,this.currentBpm=0,this.currentBeat=0,this.$refs.preview.style.bottom="0px",this.timeoutIds.forEach((function(e){return clearInterval(e)}))}},computed:{entireHeight:function(){var e,t;return(null===(e=this.measureData.last)||void 0===e?void 0:e.measurePositionBottom)+(null===(t=this.measureData.last)||void 0===t?void 0:t.measureHeight)},startOffset:function(){return this.measureData[this.startFrom].measureReachTime}},components:{Measure:w,LongNote:C}},A=D,H=(n("6599"),n("6544")),L=n.n(H),T=n("8336"),k=n("cd55"),V=n("49e2"),F=n("c865"),E=n("0393"),R=n("132d"),$=n("0fd9"),M=n("8654"),S=Object(h["a"])(A,s,u,!1,null,"794490ab",null),I=S.exports;L()(S,{VBtn:T["a"],VExpansionPanel:k["a"],VExpansionPanelContent:V["a"],VExpansionPanelHeader:F["a"],VExpansionPanels:E["a"],VIcon:R["a"],VRow:$["a"],VTextField:M["a"]});var N={name:"App",data:function(){return{isLoaded:!1,reader:new FileReader,previewAudio:new Audio,fileName:"default-song.json",difficulties:["raku","easy","normal","hard","extra"],currentDifficulty:"easy",chartObject:{info:{}},beatHeight:100}},mounted:function(){var e=this;a["a"].init(),this.reader.onload=function(t){e.chartObject=JSON.parse(t.target.result),e.isLoaded=!0}},methods:{readFile:function(e){this.fileName=e.name,this.reader.readAsText(e)},saveFile:function(){var e=new Blob([JSON.stringify(this.chartObject,null,4)],{type:"application/json"}),t=document.createElement("a");t.href=URL.createObjectURL(e),t.download=this.fileName,document.body.appendChild(t),t.click(),document.body.removeChild(t)},readAudioFile:function(e){this.previewAudio.src=window.URL.createObjectURL(e)},zoomOut:function(){this.beatHeight=this.beatHeight-10||0},zoomIn:function(){this.beatHeight=this.beatHeight+10||100}},computed:{currentChart:function(){return this.isLoaded?this.chartObject[this.currentDifficulty]:null},musicBpm:function(){return this.isLoaded?this.chartObject.info.bpm:null},musicBeat:function(){return this.isLoaded?this.chartObject.info.beat:null},musicOffset:function(){return this.isLoaded?this.chartObject.info.offset:null},maxMeasure:function(){return this.isLoaded?this.currentChart.max_by((function(e){return e.measure})).measure:1},measureData:function(){var e=this;if(!this.isLoaded)return[];var t=[],n=this.musicBeat,r=this.musicBpm,i=this.musicOffset,o=this.musicOffset/(60/r*1e3)*this.beatHeight;return this.maxMeasure.times((function(a){var s=e.currentChart.find((function(e){return 97===e.type&&e.measure===a})),u=e.currentChart.find((function(e){return 98===e.type&&e.measure===a}));s&&(n=s.option[0]),u&&(r=u.option[0]);var c=e.beatHeight*n;t.push({measure:a,measureBpm:r,measureBeat:n,measureReachTime:i,measurePositionBottom:o,measureHeight:c}),i+=60/r*n*1e3,o+=e.beatHeight*n})),t}},components:{Preview:I}},q=N,W=(n("5c0b"),n("7496")),z=n("62ad"),J=n("a523"),U=n("23a7"),G=n("b974"),K=n("ba0d"),Q=Object(h["a"])(q,i,o,!1,null,null,null),X=Q.exports;L()(Q,{VApp:W["a"],VBtn:T["a"],VCol:z["a"],VContainer:J["a"],VFileInput:U["a"],VIcon:R["a"],VRow:$["a"],VSelect:G["a"],VSlider:K["a"],VTextField:M["a"]});var Y=n("f309"),Z=n("dca6"),ee=n.n(Z);r["a"].use(Y["a"]);var te=new Y["a"]({lang:{locales:{ja:ee.a},current:"ja"}});r["a"].config.productionTip=!1,new r["a"]({vuetify:te,render:function(e){return e(X)}}).$mount("#app")},"5c0b":function(e,t,n){"use strict";var r=n("9c0c"),i=n.n(r);i.a},6599:function(e,t,n){"use strict";var r=n("484b"),i=n.n(r);i.a},"6ffe":function(e,t,n){"use strict";var r=n("f194"),i=n.n(r);i.a},"935a":function(e,t,n){"use strict";var r=n("01ba"),i=n.n(r);i.a},"9c0c":function(e,t,n){},f194:function(e,t,n){}});
//# sourceMappingURL=app.59b86fb8.js.map