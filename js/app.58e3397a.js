(function(e){function t(t){for(var o,r,s=t[0],l=t[1],c=t[2],p=0,d=[];p<s.length;p++)r=s[p],Object.prototype.hasOwnProperty.call(i,r)&&i[r]&&d.push(i[r][0]),i[r]=0;for(o in l)Object.prototype.hasOwnProperty.call(l,o)&&(e[o]=l[o]);u&&u(t);while(d.length)d.shift()();return a.push.apply(a,c||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],o=!0,s=1;s<n.length;s++){var l=n[s];0!==i[l]&&(o=!1)}o&&(a.splice(t--,1),e=r(r.s=n[0]))}return e}var o={},i={app:0},a=[];function r(t){if(o[t])return o[t].exports;var n=o[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=e,r.c=o,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/chart-editor/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],l=s.push.bind(s);s.push=t,s=s.slice();for(var c=0;c<s.length;c++)t(s[c]);var u=l;a.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"01ed":function(e,t,n){},"2e77":function(e,t,n){"use strict";var o=n("9c3a"),i=n.n(o);i.a},4228:function(e,t,n){"use strict";var o=n("01ed"),i=n.n(o);i.a},"436b":function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var o=n("2b0e"),i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-app",{attrs:{id:"app"}},[n("Preview",{attrs:{currentChart:e.currentChart,infoObject:e.chartObject.info,measureData:e.measureData,previewAudio:e.previewAudio,appendNote:e.getAppendNote,preAppendNotes:e.preAppendNotes,isShowDetail:e.isShowDetail,isShowCheckbox:e.isShowCheckbox}}),n("v-container",{staticClass:"panel",attrs:{fluid:""}},[n("h3",[e._v("譜面ファイル")]),n("v-row",{attrs:{align:"center"}},[n("v-file-input",{attrs:{accept:".json, application/json",label:"ファイルを選択","hide-details":"",outlined:"",dense:"","prepend-icon":"mdi-folder"},on:{change:e.readFile}}),n("v-col",[n("v-select",{attrs:{items:e.difficulties,label:"難易度",align:"left","hide-details":"",outlined:"",dense:""},model:{value:e.currentDifficulty,callback:function(t){e.currentDifficulty=t},expression:"currentDifficulty"}})],1)],1),n("h3",[e._v("ノートの挿入")]),n("v-checkbox",{attrs:{label:"ノート挿入モード"},model:{value:e.isAppendMode,callback:function(t){e.isAppendMode=t},expression:"isAppendMode"}}),n("div",{directives:[{name:"show",rawName:"v-show",value:e.isAppendMode,expression:"isAppendMode"}]},[n("v-checkbox",{staticClass:"mt-0",attrs:{label:"編集小節を自動追従"},model:{value:e.isAutoFollow,callback:function(t){e.isAutoFollow=t},expression:"isAutoFollow"}}),n("v-row",[n("v-col",{attrs:{cols:"12",sm:"3"}},[n("v-select",{attrs:{items:e.noteTypes,"hide-details":"",label:"ノート種別",outlined:"",dense:""},model:{value:e.appendNote.type,callback:function(t){e.$set(e.appendNote,"type",t)},expression:"appendNote.type"}})],1),n("v-col",{attrs:{cols:"12",sm:"3"}},[n("v-text-field",{attrs:{label:"measure",outlined:"",dense:"","hide-details":"",type:"number",min:"0"},model:{value:e.appendNote.measure,callback:function(t){e.$set(e.appendNote,"measure",e._n(t))},expression:"appendNote.measure"}})],1),n("v-col",{attrs:{cols:"12",sm:"3"}},[n("v-text-field",{attrs:{label:"position",outlined:"",dense:"","hide-details":"",min:"0",max:e.appendNote.split-1,"background-color":"#f0f0b0"},on:{keydown:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.placeNotes(e.appendNote)},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"left",37,t.key,["Left","ArrowLeft"])||"button"in t&&0!==t.button?null:e.appendNoteToLeft(t)},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"right",39,t.key,["Right","ArrowRight"])||"button"in t&&2!==t.button?null:e.appendNoteToRight(t)},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"up",38,t.key,["Up","ArrowUp"])?null:e.appendNoteToUp(t)},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"down",40,t.key,["Down","ArrowDown"])?null:e.appendNoteToDown(t)}]},model:{value:e.appendNote.position,callback:function(t){e.$set(e.appendNote,"position",e._n(t))},expression:"appendNote.position"}})],1),n("v-col",{attrs:{cols:"12",sm:"3"}},[n("v-combobox",{attrs:{items:[4,8,16,32,12,24,48],label:"split",outlined:"","hide-details":"",dense:""},model:{value:e.appendNote.split,callback:function(t){e.$set(e.appendNote,"split",e._n(t))},expression:"appendNote.split"}})],1)],1),e._l(e.noteOptions(e.appendNote),(function(t,o){return n("div",{key:"option_"+o,staticClass:"mb-4"},[n("v-text-field",{attrs:{"hide-details":"",label:t.label,type:t.type,"append-outer-icon":"mdi-help",outlined:"",dense:""},on:{"click:append-outer":e.scrollTo},model:{value:e.appendNote.option[o],callback:function(t){e.$set(e.appendNote.option,o,t)},expression:"appendNote.option[i]"}})],1)})),n("v-row",{attrs:{align:"center",justify:"space-between"}},[n("v-radio-group",{attrs:{row:"","prepend-icon":"mdi-view-column-outline"},model:{value:e.appendNote.lane,callback:function(t){e.$set(e.appendNote,"lane",t)},expression:"appendNote.lane"}},e._l(5,(function(e){return n("v-radio",{key:e,attrs:{value:e}})})),1),n("div",[n("v-btn",{staticClass:"ml-1 white--text",attrs:{color:"green darken-1"},on:{click:function(t){return e.placeNotes(e.appendNote)}}},[e._v(" ノートを仮配置 "),n("v-icon",{attrs:{right:""}},[e._v("mdi-keyboard-return")])],1),n("v-btn",{staticClass:"ml-4 white--text",attrs:{color:"orange darken-4"},on:{click:function(t){return e.appendNotes.apply(void 0,e.preAppendNotes)}}},[e._v(" 挿入する "),n("v-icon",{attrs:{right:""}},[e._v("mdi-plus-circle-outline")])],1)],1)],1)],2),n("h3",[e._v("プレビュー設定")]),n("v-slider",{attrs:{min:"20",max:"300","append-icon":"mdi-magnify-plus-outline","prepend-icon":"mdi-magnify-minus-outline",step:"10","thumb-label":""},on:{"click:append":e.zoomIn,"click:prepend":e.zoomOut},model:{value:e.beatHeight,callback:function(t){e.beatHeight=t},expression:"beatHeight"}}),n("v-row",{attrs:{align:"center"}},[n("v-file-input",{attrs:{accept:"audio/*",label:"楽曲ファイル選択",outlined:"",dense:"","prepend-icon":"mdi-music"},on:{change:e.readAudioFile}})],1),n("v-row",{attrs:{align:"center"}},[n("v-text-field",{attrs:{suffix:"小節へ",outlined:"",dense:"","hide-details":""},model:{value:e.scrollTo,callback:function(t){e.scrollTo=e._n(t)},expression:"scrollTo"}}),n("v-btn",{staticClass:"ml-4",attrs:{color:"primary"},on:{click:function(t){return e.scrollToMeasure(e.scrollTo)}}},[n("v-icon",{attrs:{left:""}},[e._v("mdi-arrow-right")]),e._v(" 遷移 ")],1)],1),n("v-row",{attrs:{align:"center"}},[n("v-checkbox",{attrs:{label:"ノーツ詳細を表示"},model:{value:e.isShowDetail,callback:function(t){e.isShowDetail=t},expression:"isShowDetail"}}),n("v-checkbox",{staticClass:"ml-4",attrs:{label:"チェックボックスを表示"},model:{value:e.isShowCheckbox,callback:function(t){e.isShowCheckbox=t},expression:"isShowCheckbox"}})],1),n("h3",[e._v("選択ノーツ")]),n("v-row",{attrs:{align:"center"}},[n("v-btn",{attrs:{color:"primary",text:""},on:{click:e.selectionClear}},[n("v-icon",{attrs:{left:""}},[e._v("mdi-select-off")]),e._v(" すべて選択解除 ")],1),n("v-dialog",{attrs:{width:"500"},scopedSlots:e._u([{key:"activator",fn:function(t){var o=t.on,i=t.attrs;return[n("v-btn",e._g(e._b({attrs:{color:"error",text:""},on:{click:function(t){e.dialog.selectionDelete=!0}}},"v-btn",i,!1),o),[n("v-icon",{attrs:{left:""}},[e._v("mdi-delete-forever")]),e._v(" 選択ノーツを削除 ")],1)]}}]),model:{value:e.dialog.selectionDelete,callback:function(t){e.$set(e.dialog,"selectionDelete",t)},expression:"dialog.selectionDelete"}},[n("v-card",[n("v-card-title",{staticClass:"headline"},[e._v("確認")]),n("v-card-text",[e._v(" 本当に選択したノーツをすべて削除しますか？ ")]),n("v-divider"),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{color:"primary",text:""},on:{click:function(t){e.dialog.selectionDelete=!1}}},[e._v(" キャンセル ")]),n("v-btn",{attrs:{color:"error",text:""},on:{click:e.selectionDelete}},[e._v(" 削除する ")])],1)],1)],1)],1),n("h3",[e._v("譜面情報")]),n("v-row",{attrs:{align:"center"}},[n("v-col",[n("v-text-field",{attrs:{label:"オフセット",required:"",outlined:"",dense:""},model:{value:e.chartObject.info.offset,callback:function(t){e.$set(e.chartObject.info,"offset",e._n(t))},expression:"chartObject.info.offset"}})],1),n("v-col",[n("v-text-field",{attrs:{label:"BPM",required:"",outlined:"",dense:""},model:{value:e.chartObject.info.bpm,callback:function(t){e.$set(e.chartObject.info,"bpm",e._n(t))},expression:"chartObject.info.bpm"}})],1),n("v-col",[n("v-text-field",{attrs:{label:"拍子",required:"",outlined:"",dense:""},model:{value:e.chartObject.info.beat,callback:function(t){e.$set(e.chartObject.info,"beat",e._n(t))},expression:"chartObject.info.beat"}})],1)],1),n("v-row",[n("v-btn",{staticClass:"ml-1 mb-8",attrs:{color:"success"},on:{click:e.saveFile}},[n("v-icon",{attrs:{left:""}},[e._v("mdi-content-save")]),e._v(" 名前をつけて保存 ")],1)],1)],1),n("v-snackbar",{attrs:{vertical:""},scopedSlots:e._u([{key:"action",fn:function(t){var o=t.attrs;return[n("v-btn",e._b({attrs:{color:"error",text:""},on:{click:function(t){e.snackbar=!1}}},"v-btn",o,!1),[e._v(" 閉じる ")])]}}]),model:{value:e.snackbar,callback:function(t){e.snackbar=t},expression:"snackbar"}},[e._v(" "+e._s(e.snackbarText)+" ")])],1)},a=[],r=(n("7db0"),n("d81d"),n("b0c0"),n("a9e3"),n("d3b7"),n("ac1f"),n("3ca3"),n("1276"),n("ddb0"),n("2b3d"),n("2909")),s=n("5530"),l=n("0be7"),c=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{ref:"preview",staticClass:"preview",class:{detail:e.isShowDetail,checkbox:e.isShowCheckbox},style:{position:e.isPreviewing?"fixed":"relative",height:e.entireHeight+"px"}},[e._l(e.measureData,(function(t){return n("Measure",{key:"measure_"+t.measure,attrs:{measure:t,notes:e.currentChart.filter((function(e){return e.measure===t.measure}))}})})),e._l(e.currentChart.filter((function(e){return 2===e.type})),(function(t,o){return n("LongNote",{key:"longnote_"+o,attrs:{note:t,measureData:e.measureData}})})),e.appendNote?n("NoteShadow",{attrs:{note:e.appendNote,measureData:e.measureData}}):e._e(),e._l(e.preAppendNotes,(function(t,o){return n("NoteShadow",{key:"shadow_"+t.measure+"_"+o,attrs:{note:t,measureData:e.measureData,isPreAppend:!0}})})),n("div",{staticClass:"led left",style:{background:e.ledColor}}),n("div",{staticClass:"led right",style:{background:e.ledColor}})],2),n("div",{staticClass:"control"},[n("v-expansion-panels",{attrs:{accordion:""}},[n("v-expansion-panel",[n("v-expansion-panel-header"),n("v-expansion-panel-content",[n("v-text-field",{attrs:{suffix:"小節から",outlined:"",dense:""},model:{value:e.startFrom,callback:function(t){e.startFrom=e._n(t)},expression:"startFrom"}}),n("v-btn",{staticClass:"mr-1",attrs:{outlined:"",color:"success",disabled:e.isPreviewing},on:{click:e.previewStart}},[n("v-icon",{attrs:{left:""}},[e._v("mdi-play")]),e._v(" 再生 ")],1),n("v-btn",{staticClass:"ml-2",attrs:{outlined:"",color:"error"},on:{click:e.previewStop}},[n("v-icon",{attrs:{left:""}},[e._v("mdi-stop")]),e._v(" 停止 ")],1),n("v-btn",{staticClass:"ml-2",attrs:{text:""},on:{click:e.screenshot}},[n("v-icon",[e._v("mdi-camera")])],1)],1)],1)],1)],1)])},u=[],p=(n("4160"),n("159b"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"measure",class:{hiddenControl:e.notes.find((function(e){return 95===e.type&&0===e.position}))},style:{bottom:e.measure.measurePositionBottom+"px",height:e.measure.measureHeight+"px"}},[n("v-menu",{attrs:{"offset-y":""},scopedSlots:e._u([{key:"activator",fn:function(t){var o=t.on,i=t.attrs;return[n("v-btn",e._g(e._b({attrs:{dark:"",icon:""}},"v-btn",i,!1),o),[n("v-icon",[e._v("mdi-dots-vertical")])],1)]}}])},[n("v-list",[n("v-list-item",[n("v-list-item-title",[e._v(e._s(e.measure.measure)+" 小節 ( "+e._s(e.notes.size)+" OBJ )")])],1),n("v-list-item",[e._v("到達時間："+e._s(e.measure.measureReachTime)+"ms")]),n("v-list-item",{staticClass:"px-0"},[n("v-btn",{attrs:{color:"error",text:"",disabled:""}},[n("v-icon",{attrs:{left:""}},[e._v("mdi-delete")]),e._v(" ノーツを全削除 ")],1)],1)],1)],1),e._l(4,(function(t){return n("span",{key:t,staticClass:"measure__separator",style:{left:60*t-1+"px",height:e.measure.measureHeight+"px"}})})),n("span",{staticClass:"measure__number",domProps:{textContent:e._s(e.measure.measure)}}),e._l(e.notes.filter((function(e){return 2!==e.type})),(function(t,o){return n("Note",{key:"note_"+e.measure.measure+"_"+o,attrs:{note:t,measure:e.measure,currentChart:e.notes}})}))],2)}),d=[],f=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-menu",{attrs:{"close-on-click":!1,"close-on-content-click":!1,absolute:"",left:"","nudge-left":50,"max-width":240},scopedSlots:e._u([{key:"activator",fn:function(t){var o,i=t.on,a=t.attrs;return[n("span",e._g(e._b({staticClass:"note",class:(o={},o["type"+e.note.type]=!0,o.hidden=e.isHiddenControl,o.menu=e.menu,o),style:{left:e.positionLeft+"px",bottom:e.positionBottom+"px",width:e.noteWidth+"px"}},"span",a,!1),i),[n("input",{directives:[{name:"model",rawName:"v-model",value:e.note.isSelected,expression:"note.isSelected"}],attrs:{type:"checkbox",id:e.note.index},domProps:{checked:Array.isArray(e.note.isSelected)?e._i(e.note.isSelected,null)>-1:e.note.isSelected},on:{click:function(e){e.stopPropagation()},change:function(t){var n=e.note.isSelected,o=t.target,i=!!o.checked;if(Array.isArray(n)){var a=null,r=e._i(n,a);o.checked?r<0&&e.$set(e.note,"isSelected",n.concat([a])):r>-1&&e.$set(e.note,"isSelected",n.slice(0,r).concat(n.slice(r+1)))}else e.$set(e.note,"isSelected",i)}}}),e.isDuplicated(e.note)?n("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var o=t.on,i=t.attrs;return[n("v-icon",e._g(e._b({staticClass:"mt-2",attrs:{color:"warn",dark:""}},"v-icon",i,!1),o),[e._v(" mdi-alert ")])]}}],null,!0)},[n("span",[e._v(e._s(e.isDuplicated(e.note))+"個の重複")])]):e._e(),e.hasError(e.note)?n("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var o=t.on,i=t.attrs;return[n("v-icon",e._g(e._b({staticClass:"mt-2",attrs:{color:"error",dark:""}},"v-icon",i,!1),o),[e._v(" mdi-alert-circle-outline ")])]}}],null,!0)},[n("span",[e._v(e._s(e.hasError(e.note)))])]):e._e(),e._v(" "+e._s(e.note.position)+"/"+e._s(e.note.split)+" "),97===e.note.type?n("strong",[e._v("BEAT "+e._s(e.note.option[0]))]):e._e(),98===e.note.type?n("strong",[e._v("BPM "+e._s(e.note.option[0]))]):e._e(),99===e.note.type?n("strong",[e._v("EOF")]):e._e()],1)]}}]),model:{value:e.menu,callback:function(t){e.menu=t},expression:"menu"}},[e.menu?n("v-card",[n("v-list",[n("v-list-item",[n("v-card-text",[e._v("#"+e._s(e.note.index)+" "+e._s(e.noteTypeName))]),n("v-spacer"),n("v-btn",{attrs:{icon:"",right:""},on:{click:function(t){e.menu=!1}}},[n("v-icon",[e._v("mdi-close")])],1)],1),n("v-list-item",[n("v-row",[n("v-col",[n("v-text-field",{attrs:{value:e.note.measure,"hide-details":"",suffix:"小節",outlined:"",dense:"",min:"1",max:"5"},on:{change:function(t){return e.note.measure=Number(t)}}})],1)],1)],1),n("v-list-item",[n("v-row",[n("v-col",{attrs:{cols:"12",sm:"6"}},[n("v-text-field",{attrs:{label:"position",outlined:"",dense:"","hide-details":"",type:"number"},model:{value:e.note.position,callback:function(t){e.$set(e.note,"position",t)},expression:"note.position"}})],1),n("v-col",{attrs:{cols:"12",sm:"6"}},[n("v-text-field",{attrs:{label:"split",outlined:"",dense:"","hide-details":"",type:"number"},model:{value:e.note.split,callback:function(t){e.$set(e.note,"split",t)},expression:"note.split"}})],1)],1)],1),n("v-list-item",[e._v(" LANE "),n("v-spacer"),n("v-radio-group",{attrs:{row:""},model:{value:e.note.lane,callback:function(t){e.$set(e.note,"lane",t)},expression:"note.lane"}},e._l(5,(function(e){return n("v-radio",{key:e,attrs:{value:e}})})),1)],1),n("v-list-item",[n("v-select",{attrs:{items:e.noteTypes,"hide-details":"",label:"ノート種別",align:"left",outlined:"",dense:""},model:{value:e.note.type,callback:function(t){e.$set(e.note,"type",t)},expression:"note.type"}})],1),e.noteOptions(e.note).length>0?n("v-list-item",[n("v-card-text",[e._v("オプション")]),n("v-spacer"),n("v-btn",{attrs:{href:"https://github.com/mtsgi/fumenedit/blob/master/format.md",target:"_blank",icon:"",right:""}},[n("v-icon",[e._v("mdi-help")])],1)],1):e._e(),e._l(e.noteOptions(e.note),(function(t,o){return n("v-list-item",{key:"option_"+o},[n("v-text-field",{attrs:{"hide-details":"",label:t.label,type:t.type,outlined:"",dense:""},model:{value:e.note.option[o],callback:function(t){e.$set(e.note.option,o,t)},expression:"note.option[i]"}})],1)}))],2),n("v-card-actions",[n("v-btn",{attrs:{color:"error",text:""},on:{click:e.deleteThisNote}},[e._v(" ノートを削除 ")])],1)],1):e._e()],1)},m=[],v=(n("caad"),{data:function(){return{noteTypes:[{text:"通常",value:1},{text:"ロング",value:2,disabled:!0},{text:"左フリック",value:3},{text:"右フリック",value:4},{text:"音札",value:5,disabled:!0},{text:"区切り線",value:95},{text:"拍子変化",value:97},{text:"BPM変化",value:98},{text:"EOF",value:99}]}},methods:{noteOptions:function(e){return[3,4].includes(e.type)?[{label:"width",type:"number"},{label:"offsetNumer",type:"number"},{label:"offsetDenom",type:"number"}]:95===e.type?[{label:"length",type:"number"}]:97===e.type?[{label:"beat",type:"number"}]:98===e.type?[{label:"bpm",type:"number"}]:[]}}}),h={methods:{isDuplicated:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{checkPreAppend:!0};if(this.currentChart){var n=e.position/e.split,o=0;return this.currentChart.each((function(t){t.measure===e.measure&&t.lane===e.lane&&t.position/t.split===n&&([3,4].includes(t.type)||[3,4].includes(e.type)||t.index!==e.index&&o++)})),t.checkPreAppend&&this.preAppendNotes&&this.preAppendNotes.each((function(t){t.measure===e.measure&&t.lane===e.lane&&t.position/t.split===n&&([3,4].includes(t.type)||[3,4].includes(e.type)||o++)})),o}return 1/0},hasError:function(e){return e.split<=0?"splitの値は0より大きい必要があります。":e.position<0?"positionの値は0以上である必要があります。":e.position>=e.split?"positionの値はsplitの値未満である必要があります。":[-1,1,2,3,4,5].includes(e.lane)?![1,2,3,4,5,95,96,97,98,99].includes(e.type)&&"不正なノートタイプです。":"不正なノートのレーン位置です。"}}},b={mixins:[v,h],data:function(){return{menu:!1}},props:{note:{type:Object,required:!0},measure:{type:Object,required:!0},currentChart:{type:Array,required:!0}},methods:{deleteThisNote:function(){this.$root.$children.first.deleteNote(this.note.index),this.menu=!1}},computed:{positionLeft:function(){if([1,2,95].includes(this.note.type))return 60*(this.note.lane-1);if([3,4].includes(this.note.type)){var e=this.note.option[0]||3;-1===e&&(e=3);var t=60*(this.note.lane-1)+30,n=0;return this.note.option[1]&&this.note.option[2]&&(n=this.note.option[1]/this.note.option[2]*60),t-e/2*60+n}return 0},positionBottom:function(){return this.note.position/this.note.split*this.measure.measureHeight},noteWidth:function(){if([1,2].includes(this.note.type))return 60;if([3,4].includes(this.note.type)){var e=this.note.option[0]||3;return-1===e&&(e=3),60*e}if(95===this.note.type){var t=this.note.option[0]||1;return-1===t&&(t=1),0===this.note.position&&(t=5),60*t}return 300},isHiddenControl:function(){return 95===this.note.type&&0===this.note.position},noteTypeName:function(){var e,t=this;return null===(e=this.noteTypes.find((function(e){return e.value===t.note.type})))||void 0===e?void 0:e.text}}},y=b,x=(n("f626"),n("2877")),_=n("6544"),g=n.n(_),k=n("8336"),w=n("b0af"),N=n("99d9"),C=n("62ad"),O=n("132d"),A=n("8860"),j=n("da13"),D=n("e449"),T=n("67b6"),S=n("43a6"),V=n("0fd9"),P=n("b974"),B=n("2fa4"),$=n("8654"),L=n("3a2f"),M=Object(x["a"])(y,f,m,!1,null,"75b0b473",null),F=M.exports;g()(M,{VBtn:k["a"],VCard:w["a"],VCardActions:N["a"],VCardText:N["b"],VCol:C["a"],VIcon:O["a"],VList:A["a"],VListItem:j["a"],VMenu:D["a"],VRadio:T["a"],VRadioGroup:S["a"],VRow:V["a"],VSelect:P["a"],VSpacer:B["a"],VTextField:$["a"],VTooltip:L["a"]});var H={props:{notes:{type:Array,default:function(){return[]}},measure:{type:Object,required:!0},measureData:{type:Array,default:function(){return[]}}},components:{Note:F}},R=H,E=(n("2e77"),n("5d23")),I=Object(x["a"])(R,p,d,!1,null,"00d07c9a",null),q=I.exports;g()(I,{VBtn:k["a"],VIcon:O["a"],VList:A["a"],VListItem:j["a"],VListItemTitle:E["b"],VMenu:D["a"]});var z=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-menu",{attrs:{"close-on-click":!1,"close-on-content-click":!1,absolute:"",left:"","nudge-left":50,"max-width":240},scopedSlots:e._u([{key:"activator",fn:function(t){var o=t.on,i=t.attrs;return[n("span",{staticClass:"note",class:"type"+e.note.type,style:{left:e.getLeft(e.note)+"px",bottom:e.getBottom(e.note)+"px",width:e.getWidth(e.note)+"px"}},[e._v(e._s(e.note.position)+"/"+e._s(e.note.split))]),e._l(e.note.end,(function(t,a){return n("div",{key:a},[n("span",{staticClass:"note",class:"type"+t.type,style:{left:e.getLeft(t)+"px",bottom:e.getBottom(t)+"px",width:e.getWidth(t)+"px"}},[e._v(e._s(e.note.position)+"/"+e._s(e.note.split))]),n("i",e._g(e._b({staticClass:"note-hold",style:{bottom:e.getBottom(e.note)+"px",left:e.getLeft(t)+"px",height:e.getBottom(t)-e.getBottom(e.note)+"px"}},"i",i,!1),o))])}))]}}]),model:{value:e.menu,callback:function(t){e.menu=t},expression:"menu"}},[n("v-card",[n("v-list",[n("v-list-item",[n("v-card-text",[e._v("#"+e._s(e.note.index)+" ロング")]),n("v-spacer"),n("v-btn",{attrs:{icon:"",right:""},on:{click:function(t){e.menu=!1}}},[n("v-icon",[e._v("mdi-close")])],1)],1)],1),n("v-card-actions",[n("v-btn",{attrs:{color:"error",text:""},on:{click:e.deleteThisNote}},[n("v-icon",{attrs:{left:""}},[e._v("mdi-delete")]),e._v(" ノートを削除 ")],1)],1)],1)],1)},J=[],U={data:function(){return{menu:!1}},props:{note:{type:Object,required:!0},measureData:{type:Array,required:!0}},methods:{getLeft:function(e){return 60*(e.lane-1)+60},getBottom:function(e){return this.measureData[e.measure].measurePositionBottom+e.position/e.split*this.measureData[e.measure].measureHeight},getWidth:function(){return 60},deleteThisNote:function(){this.$root.$children.first.deleteNote(this.note.index),this.menu=!1}}},W=U,G=(n("ff47"),Object(x["a"])(W,z,J,!1,null,"df030ed4",null)),Z=G.exports;g()(G,{VBtn:k["a"],VCard:w["a"],VCardActions:N["a"],VCardText:N["b"],VIcon:O["a"],VList:A["a"],VListItem:j["a"],VMenu:D["a"],VSpacer:B["a"]});var Y=function(){var e,t=this,n=t.$createElement,o=t._self._c||n;return o("div",[o("span",{staticClass:"note",class:(e={},e["type"+t.note.type]=!0,e.shadow=!t.isPreAppend,e.preappend=t.isPreAppend,e),style:{left:t.getAbsoluteLeft(t.note)+"px",bottom:t.getAbsoluteBottom(t.note)+"px",width:t.getWidth(t.note)+"px"},on:{click:t.calcelThisNote}},[t._v(t._s(t.note.position)+"/"+t._s(t.note.split))]),t._l(t.note.end,(function(e,n){return o("div",{key:n},[o("span",{staticClass:"note",class:"type"+e.type,style:{left:t.getAbsoluteLeft(e)+"px",bottom:t.getAbsoluteBottom(e)+"px",width:t.getWidth(e)+"px"}},[t._v(t._s(t.note.position)+"/"+t._s(t.note.split))]),o("i",{staticClass:"note-hold",style:{bottom:t.getAbsoluteBottom(t.note)+"px",left:t.getAbsoluteLeft(e)+"px",height:t.getAbsoluteBottom(e)-t.getAbsoluteBottom(t.note)+"px"}})])}))],2)},K=[],Q={props:{note:{type:Object,required:!0},measureData:{type:Array,required:!0},isPreAppend:{type:Boolean,default:!1}},methods:{getLeft:function(e){if([1,2,95].includes(e.type))return 60*(e.lane-1);if([3,4].includes(e.type)){var t=e.option[0]||3;-1===t&&(t=3);var n=60*(e.lane-1)+30,o=0;return e.option[1]&&e.option[2]&&(o=e.option[1]/e.option[2]*60),n-t/2*60+o}return 0},getAbsoluteLeft:function(e){return this.getLeft(e)+60},getBottom:function(e){var t=this.measureData[e.measure]||this.measureData.last;return e.position/e.split*t.measureHeight},getAbsoluteBottom:function(e){var t=this.measureData[e.measure];if(t)return t.measurePositionBottom+e.position/e.split*t.measureHeight;var n=this.measureData.last,o=e.measure-n.measure;return console.log(o),o*n.measureHeight+n.measurePositionBottom+e.position/e.split*n.measureHeight},getWidth:function(e){if([1,2].includes(e.type))return 60;if([3,4].includes(e.type)){var t=e.option[0]||3;return-1===t&&(t=3),60*t}if(95===e.type){var n=e.option[0]||1;return-1===n&&(n=1),0===e.position&&(n=5),60*n}return 300},calcelThisNote:function(){this.isPreAppend&&this.$root.$children.first.cancelNote(this.note.index)}}},X=Q,ee=(n("4228"),Object(x["a"])(X,Y,K,!1,null,"79b7d06c",null)),te=ee.exports,ne=n("c0e9"),oe=n.n(ne),ie={data:function(){return{isPreviewing:!1,returnPosition:-1,currentPosition:0,timeoutIds:[],intervalId:null,startFrom:0,currentMeasure:0,currentBpm:0,currentBeat:0,ledColor:"linear-gradient(0deg, #ff5151 30%, #44a5ff 70%)"}},props:{currentChart:{type:Array,default:function(){return[]}},measureData:{type:Array,default:function(){return[]}},previewAudio:{type:HTMLAudioElement},infoObject:{type:Object,required:!0},appendNote:{type:Object},preAppendNotes:{type:Array},isShowDetail:{type:Boolean,default:!1},isShowCheckbox:{type:Boolean,default:!1}},methods:{screenshot:function(){oe()(document.querySelector(".preview"),{allowTaint:!0}).then((function(e){document.querySelector(".panel").appendChild(e)}))},playFromMeasure:function(){var e=this,t=this.startOffset,n=60/this.infoObject.bpm*this.infoObject.beat*1e3;setTimeout((function(){e.previewAudio.currentTime=t/1e3,e.previewAudio.play()}),n),this.measureData.forEach((function(n,o){var i=e.measureData[o+1]||{};n.measureReachTime>t&&e.timeoutIds.push(setTimeout((function(){e.currentPosition=i.measurePositionBottom;var t=i.measureReachTime-n.measureReachTime;e.$refs.preview.style.transition="".concat(t,"ms all linear"),e.$refs.preview.style.bottom="-".concat(e.currentPosition,"px")}),n.measureReachTime-t))}))},playFromZero:function(){var e=this;setTimeout((function(){e.previewAudio.currentTime=0,e.previewAudio.play()}),60/this.infoObject.bpm*this.infoObject.beat*1e3);var t=Object(r["a"])(this.measureData);t.forEach((function(n,o){var i=t[o+1]||{};e.timeoutIds.append(setTimeout((function(){e.currentPosition=i.measurePositionBottom;var t=i.measureReachTime-n.measureReachTime;e.$refs.preview.style.transition="".concat(t,"ms all linear"),e.$refs.preview.style.bottom="-".concat(e.currentPosition,"px")}),n.measureReachTime))}))},previewStart:function(){this.returnPosition=window.scrollY,this.isPreviewing=!0,this.$refs.preview.style.transition="0ms all linear",this.$refs.preview.style.bottom="-".concat(this.measureData.first.measurePositionBottom,"px"),0===this.startFrom?this.playFromZero():this.playFromMeasure()},previewStop:function(){this.previewAudio.pause(),this.isPreviewing=!1,this.currentPosition=0,this.currentBpm=0,this.currentBeat=0,this.$refs.preview.style.transition="0ms all linear",this.$refs.preview.style.bottom="0px",this.timeoutIds.each((function(e){return clearInterval(e)})),this.$vuetify.goTo(this.returnPosition),this.returnPosition=-1}},computed:{entireHeight:function(){var e,t;return(null===(e=this.measureData.last)||void 0===e?void 0:e.measurePositionBottom)+(null===(t=this.measureData.last)||void 0===t?void 0:t.measureHeight)},startOffset:function(){return this.measureData[this.startFrom].measureReachTime},previewDelay:function(){return 10*this.measureData.size+100}},components:{Measure:q,LongNote:Z,NoteShadow:te}},ae=ie,re=(n("9e94"),n("cd55")),se=n("49e2"),le=n("c865"),ce=n("0393"),ue=Object(x["a"])(ae,c,u,!1,null,"5cff336d",null),pe=ue.exports;g()(ue,{VBtn:k["a"],VExpansionPanel:re["a"],VExpansionPanelContent:se["a"],VExpansionPanelHeader:le["a"],VExpansionPanels:ce["a"],VIcon:O["a"],VTextField:$["a"]});var de={name:"App",mixins:[v,h],data:function(){return{isLoaded:!1,reader:new FileReader,previewAudio:new Audio,fileName:"default-song.json",difficulties:["raku","easy","normal","hard","extra"],currentDifficulty:"easy",chartObject:{raku:[],easy:[],normal:[],hard:[],extra:[],info:{offset:0,bpm:120,beat:4}},dialog:{selectionDelete:!1},appendNote:{type:1,lane:1,measure:1,position:0,split:8,option:[]},preAppendNotes:[],isAppendMode:!0,isAutoFollow:!0,scrollTo:0,isShowDetail:!1,isShowCheckbox:!1,snackbar:!1,snackbarText:"メッセージ",beatHeight:100}},beforeCreate:l["a"].init,mounted:function(){var e=this;this.reader.onload=function(t){e.chartObject=JSON.parse(t.target.result),e.difficulties.each((function(t){e.chartObject[t]=e.chartObject[t].map((function(e,t){return Object(s["a"])(Object(s["a"])({},e),{},{index:t,isSelected:!1})}))})),e.isLoaded=!0}},methods:{readFile:function(e){this.fileName=e.name,this.reader.readAsText(e)},newFile:function(){this.fileName="default.json",this.isLoaded=!0},saveFile:function(){var e=this,t={raku:[],easy:[],normal:[],hard:[],extra:[],info:Object(s["a"])({},this.chartObject.info)};this.difficulties.each((function(n){t[n]=e.chartObject[n].map((function(e){return{type:Number(e.type),measure:Number(e.measure),lane:Number(e.lane),position:Number(e.position),split:Number(e.split),option:Object(r["a"])(e.option),end:e.end}}))})),console.log("saveObject",t);var n=new Blob([JSON.stringify(t,null,4)],{type:"application/json"}),o=document.createElement("a");o.href=URL.createObjectURL(n),o.download=this.fileName,document.body.appendChild(o),o.click(),document.body.removeChild(o)},readAudioFile:function(e){this.previewAudio.src=window.URL.createObjectURL(e)},zoomOut:function(){this.beatHeight=this.beatHeight-10||0},zoomIn:function(){this.beatHeight=this.beatHeight+10||100},scrollToMeasure:function(e){var t,n=(null===(t=this.measureData.last)||void 0===t?void 0:t.measurePositionBottom)-this.measureData[e].measurePositionBottom;this.$vuetify.goTo(n)},appendNotes:function(){for(var e=this,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];n.each((function(t){var n,o=e.isDuplicated(t,{checkPreAppend:!1});if(o)return e.showSnackbar("".concat(o,"個のノーツと重複しているため、挿入できないノーツがあります")),!1;null===(n=e.currentChart)||void 0===n||n.append(Object(s["a"])({isSelected:!1,index:e.currentChart.size},JSON.parse(JSON.stringify(t))))})),this.preAppendNotes=[]},placeNotes:function(){for(var e=this,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];n.each((function(t){var n=e.isDuplicated(t);if(n)return e.showSnackbar("".concat(n,"個のノーツと重複しているため、配置はキャンセルされました")),!1;e.preAppendNotes.append(Object(s["a"])({isSelected:!1,index:e.preAppendNotes.size},JSON.parse(JSON.stringify(t))))}))},appendNoteToLeft:function(){this.appendNote.lane=Math.max(this.appendNote.lane-1,1)},appendNoteToRight:function(){this.appendNote.lane=Math.min(this.appendNote.lane+1,5)},appendNoteToUp:function(){var e=this.appendNote;e.split-1<=e.position?(e.measure++,e.position=0,this.isAutoFollow&&this.measureData[e.measure]&&this.scrollToMeasure(e.measure)):e.position++},appendNoteToDown:function(){var e=this.appendNote;0===e.position?(e.measure--,e.position=e.split-1,this.isAutoFollow&&this.scrollToMeasure(e.measure)):e.position--},deleteNote:function(e){var t;this.chartObject[this.currentDifficulty]=null===(t=this.currentChart)||void 0===t?void 0:t.delete_if((function(t){return t.index===e}))},cancelNote:function(e){var t;this.preAppendNotes=null===(t=this.preAppendNotes)||void 0===t?void 0:t.delete_if((function(t){return t.index===e}))},selectionClear:function(){var e;this.chartObject[this.currentDifficulty]=null===(e=this.currentChart)||void 0===e?void 0:e.map((function(e){return Object(s["a"])(Object(s["a"])({},e),{},{isSelected:!1})}))},selectionDelete:function(){var e;this.chartObject[this.currentDifficulty]=null===(e=this.currentChart)||void 0===e?void 0:e.delete_if((function(e){return e.isSelected})),this.dialog.selectionDelete=!1},showSnackbar:function(e){var t=this;this.snackbar=!1,this.snackbarText=e,setTimeout((function(){return t.snackbar=!0}),100)}},computed:{currentChart:function(){return this.chartObject[this.currentDifficulty]||[]},musicBpm:function(){return this.chartObject.info.bpm},musicBeat:function(){return this.chartObject.info.beat},musicOffset:function(){return this.chartObject.info.offset},maxMeasure:function(){return this.currentChart.size>0?this.currentChart.max_by((function(e){return e.measure})).measure:1},measureData:function(){var e=this,t=[],n=this.musicBeat,o=this.musicBpm,i=this.musicOffset,a=this.musicOffset/(60/o*1e3)*this.beatHeight;return(this.maxMeasure+1).times((function(r){var s=e.currentChart.find((function(e){return 97===e.type&&e.measure===r})),l=e.currentChart.find((function(e){return 98===e.type&&e.measure===r}));s&&(n=s.option[0]),l&&(o=l.option[0]);var c=e.beatHeight*n;t.push({measure:r,measureBpm:o,measureBeat:n,measureReachTime:i,measurePositionBottom:a,measureHeight:c}),i+=60/o*n*1e3,a+=e.beatHeight*n})),t},getAppendNote:function(){return this.isAppendMode?this.appendNote:null}},components:{Preview:pe}},fe=de,me=(n("5c0b"),n("7496")),ve=n("ac7c"),he=n("2b5d"),be=n("a523"),ye=n("169a"),xe=n("ce7e"),_e=n("23a7"),ge=n("ba0d"),ke=n("2db4"),we=Object(x["a"])(fe,i,a,!1,null,null,null),Ne=we.exports;g()(we,{VApp:me["a"],VBtn:k["a"],VCard:w["a"],VCardActions:N["a"],VCardText:N["b"],VCardTitle:N["c"],VCheckbox:ve["a"],VCol:C["a"],VCombobox:he["a"],VContainer:be["a"],VDialog:ye["a"],VDivider:xe["a"],VFileInput:_e["a"],VIcon:O["a"],VRadio:T["a"],VRadioGroup:S["a"],VRow:V["a"],VSelect:P["a"],VSlider:ge["a"],VSnackbar:ke["a"],VSpacer:B["a"],VTextField:$["a"]});var Ce=n("f309"),Oe=n("dca6"),Ae=n.n(Oe);o["a"].use(Ce["a"]);var je=new Ce["a"]({lang:{locales:{ja:Ae.a},current:"ja"}});o["a"].config.productionTip=!1,new o["a"]({vuetify:je,render:function(e){return e(Ne)}}).$mount("#app")},"5c0b":function(e,t,n){"use strict";var o=n("9c0c"),i=n.n(o);i.a},"9c0c":function(e,t,n){},"9c3a":function(e,t,n){},"9e94":function(e,t,n){"use strict";var o=n("436b"),i=n.n(o);i.a},aa21:function(e,t,n){},f626:function(e,t,n){"use strict";var o=n("aa21"),i=n.n(o);i.a},ff39:function(e,t,n){},ff47:function(e,t,n){"use strict";var o=n("ff39"),i=n.n(o);i.a}});
//# sourceMappingURL=app.58e3397a.js.map